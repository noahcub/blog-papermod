[{"content":"Traefik y crowdsec Estoy hasta el gorro de la liga y sus pu√±eteros bloqueos. Este blog y mis servicios estaban configurados en el NAS con un traefik como proxy inverso. Para proteger mi IP p√∫blica uso el Proxied de cloudflare, que adem√°s aporta un WAF muy potente, geolocalizaci√≥n, etc. PROBLEMA: cada vez que hay futbol pierdo la conexi√≥n a homeassistant y otros servicios que para mi son muy importantes.\nHoy vamos a configurar traefik en un VPS y desde all√≠ enrutamos todo el tr√°fico a nuestro NAS local a trav√©s de Tailscale. Desactivaremos el proxied de cloudflare y de esta forma no est√° expuesta mi IP p√∫blica, s√≥lo est√° expuesta la IP del VPS.\nHe contratado el VPS m√°s econ√≥mico que tiene Piensasolutions. En mi caso pago 0,75‚Ç¨ al mes durante 12 meses y despu√©s el coste pasa a ser 1‚Ç¨ al mes.\nEl VPS tiene 1 GB de RAM, 1 vCPU, 10GB SSD NVMe y conexi√≥n de 1Gbps.\nAl principio intent√© instalar Pangol√≠n, que ya lo tuve operativo en un VPS de prueba m√°s potente. Pero creo que en este servidor es muy exigente y no puede para nada con √©l. Solo Pangol√≠n consume 300 Mb de RAM m√°s el sistema, crowdsec, etc. IMPOSIBLE !!!!!\nPreparaci√≥n del entorno Como sistema operativo tengo Debian 13. Una maravilla que consume pocos recursos. Instalamos y actualizamos:\nsudo apt update \u0026amp;\u0026amp; sudo apt upgrade -y Instalamos Tailscale:\ncurl -fsSL https://tailscale.com/install.sh | sh sudo tailscale up -d Configuraci√≥n del Firewall. Instalamos ufw:\nsudo apt install ufw # Reglas iniciales sudo ufw default deny incoming # Ojo con esta regla estamos bloqueando hasta el ssh, que luego permitimos a trav√©s de tailscale. sudo ufw default allow outgoing #Permitimos todo el tr√°fico a trav√©s de tailscale0 sudo ufw allow in on tailscale0 # Puertos 80 y 443 para traefik sudo ufw allow 80/tcp sudo ufw allow 443/tcp # Activamos el firewall sudo ufw enable # Verificamos reglas sudo ufw status numbered Status: active To Action From -- ------ ---- [ 1] Anywhere on tailscale0 ALLOW IN Anywhere [ 2] 80/tcp ALLOW IN Anywhere [ 3] 443/tcp ALLOW IN Anywhere [ 5] Anywhere (v6) on tailscale0 ALLOW IN Anywhere (v6) [ 6] 80/tcp (v6) ALLOW IN Anywhere (v6) [ 7] 443/tcp (v6) ALLOW IN Anywhere (v6) # Nota para borrar alguna regla: sudo ufw delete 8 # Antes de cerrar esta sesi√≥n abrimos otra terminal y probamos a conectar por ssh. Si hubiera alg√∫n fallo siempre tenemos la opci√≥n de acceder a trav√©s de la web de nuestro VPS. En nuestro panel de control del VPS verificamos que los puertos que vamos a usar est√©n abiertos. En este caso necesitamos los puertos 80 y 443: Mi dominio est√° registrado en cloudflare. Tenemos que apuntar los registros DNS a la IP p√∫blica de nuestro VPS. Desactivamos el Proxied y nos quedamos sin protecci√≥n para evitar que la dichosa liga y sus esbirros nos jodan a los pobres de a pie. Dejamos la nube de color gris para que cloudflare dirija el tr√°fico de forma transparente al VPS. CLoudflare nos muestra el siguiente aviso, pero da igual, nos jodemos porques estamos compartiendo la misma IP que alguna web ilegal. Cortamos medio internet y encima no se dan cuenta que no est√°n consiguiendo nada, casi est√°n animando a todo lo contrario. En fin que me caliento.\nEs necesario redirigir mediante proxy para la mayor√≠a de las funciones de seguridad y rendimiento Para configurar sus registros DNS estableciendo la opci√≥n redirigido mediante proxy haga clic en \u0026#34;Editar\u0026#34; en la tabla siguiente y se beneficiar√° de la protecci√≥n DDoS, las reglas de seguridad, el almacenamiento en cach√© y mucho m√°s. Por √∫ltimo necesitamos una API Key de cloudflare para los certificados.\nInstalamos docker:\nsudo apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin docker version docker compose version # Damos permisos a nuestro usuario para ejecutar docker sin sudo sudo usermod -aG docker $USER Docker compose de traefik y crowdsec Creamos directorios:\nmkdir -p /home/noah/traefik-crowdsec mkdir -p /home/noah/traefik-crowdsec/traefik/{conf.d,logs,ssl} mkdir -p /home/noah/traefik-crowdsec/crowdsec/{config,data} Dentro de /home/noah/traefik-crowdsec creamos nuestro docker-compose.yml:\nservices: traefik: image: traefik:v3.5.0 container_name: traefik hostname: traefik restart: unless-stopped security_opt: - no-new-privileges:true environment: TZ: ${TZ:-Europe/Madrid} CF_DNS_API_TOKEN: ${CF_DNS_API_TOKEN} networks: - traefik ports: - \u0026#34;80:80\u0026#34; - \u0026#34;443:443\u0026#34; volumes: - /usr/share/zoneinfo/${TZ:-Europe/Madrid}:/etc/localtime:ro - ./traefik/traefik.yml:/traefik.yml:ro - ./traefik/conf.d:/conf.d:ro - ./traefik/ssl:/ssl - ./traefik/logs:/var/log/traefik crowdsec: image: crowdsecurity/crowdsec:latest container_name: crowdsec restart: unless-stopped environment: - COLLECTIONS=crowdsecurity/traefik crowdsecurity/http-cve # ESTAS COLECCIONES LAS A√ëADIREMOS LUEGO crowdsecurity/appsec-virtual-patching crowdsecurity/appsec-generic-rules - DISABLE_CAPI=true # Ignora CAPI completamente volumes: - ./traefik/logs:/var/log/traefik:ro # comparte los logs - ./crowdsec/data:/var/lib/crowdsec/data - ./crowdsec/config:/etc/crowdsec networks: - traefik networks: traefik: name: traefik IMPORTANTE: Las colecciones de crowdsec que he incluido son las siguientes:\n- COLLECTIONS=crowdsecurity/traefik crowdsecurity/http-cve crowdsecurity/appsec-virtual-patching crowdsecurity/appsec-generic-rules # La coleccion appsec es para usar el WAF integrado que tiene crowdsec Creamos nuestro fichero .env:\nTZ=Europe/Madrid CF_DNS_API_TOKEN=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX Ficheros de configuraci√≥n de traefik Fichero traefik.yml:\n# Global configuration global: checknewversion: false sendanonymoususage: false # API and dashboard configuration api: insecure: false dashboard: true debug: false # Load dynamic configuration from .yaml files in a directory - Routers providers: file: directory: /conf.d watch: true # Certificate Resolvers certificatesResolvers: letsencrypt: acme: email: micorreo@gmail.com storage: /ssl/acme.json caServer: https://acme-v02.api.letsencrypt.org/directory dnsChallenge: provider: cloudflare # resolvers: # - \u0026#34;1.1.1.1:53\u0026#34; # - \u0026#34;1.0.0.1:53\u0026#34; letsencrypt_staging: acme: email: micorreo@gmail.com storage: /ssl/acme.json caServer: https://acme-staging-v02.api.letsencrypt.org/directory dnsChallenge: provider: cloudflare # resolvers: # - \u0026#34;1.1.1.1:53\u0026#34; # - \u0026#34;1.0.0.1:53\u0026#34; # EntryPoints configuration entryPoints: web: address: \u0026#34;:80\u0026#34; http: redirections: entryPoint: to: websecure scheme: https websecure: address: \u0026#34;:443\u0026#34; http: tls: certResolver: letsencrypt # certResolver: letsencrypt_staging middlewares: - geoblock-es - crowdsec-bouncer - security-headers accessLog: filePath: \u0026#34;/var/log/traefik/access.log\u0026#34; format: json bufferingSize: 100 fields: headers: defaultMode: keep # Mantiene headers para que CrowdSec vea IPs reales # PLUGINS (CrowdSec Bouncer para Traefik v3) experimental: plugins: crowdsec-bouncer: moduleName: github.com/maxlerebourg/crowdsec-bouncer-traefik-plugin version: v1.5.1 # Ultima versi√≥n en el momento de la configuraci√≥n. IMPORTANTE VERIFICAR geoblock: moduleName: github.com/PascalMinder/geoblock version: v0.3.6 IMPORTANTE: Para hacer pruebas usaremos el certResolver: letsencrypt_staging. Una vez est√© todo configurado cambiamos a certResolver: letsencrypt. En el blog de manelrodero explica muy bien el motivo.\nDentro de ssl creamos nuestro fichero acme.json para los certificados:\ntouch acme.json chmod 600 acme.json Dentro de conf.d crearemos nuestros ficheros para dashboard, middlewares y distintos servicios. Fichero dashboard.yml:\nhttp: routers: dashboard: rule: \u0026#34;Host(`traefik.midominio.com`)\u0026#34; service: api@internal entryPoints: - websecure tls: certResolver: letsencrypt middlewares: - auth Fichero middelwares.yml:\nhttp: middlewares: auth: basicAuth: # Generar con: echo $(htpasswd -nB usuario) | sed -e s/\\\\$/\\\\$\\\\$/g users: - \u0026#34;noah:$XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\u0026#34; security-headers: headers: stsSeconds: 15552000 stsIncludeSubdomains: true stsPreload: true forceSTSHeader: true frameDeny: true # Previene Clickjacking contentTypeNosniff: true # Previene sniffing de MIME browserXssFilter: true referrerPolicy: \u0026#34;same-origin\u0026#34; # Ajuste para Nextcloud: customFrameOptionsValue: \u0026#34;SAMEORIGIN\u0026#34; crowdsec-bouncer: plugin: crowdsec-bouncer: Enabled: true CrowdsecMode: live # o streaming si prefieres # Identidad fija para evitar los \u0026#34;bouncers fantasmas\u0026#34; bouncerName: \u0026#34;traefik-bouncer\u0026#34; # Conexi√≥n a la LAPI (Local API) CrowdsecLapiUrl: \u0026#34;http://crowdsec:8080\u0026#34; CrowdsecLapiKey: \u0026#34;07F+XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\u0026#34; # Configuraci√≥n del WAF se a√±ade luego junto con las colecciones (AppSec) crowdsecAppsecEnabled: true crowdsecAppsecHost: \u0026#34;crowdsec:7422\u0026#34; # Puerto por defecto del WAF en el contenedor crowdsec crowdsecAppsecFailureBlock: true crowdsecAppsecUnreachableBlock: true #appsecFailureAction: \u0026#34;passthrough\u0026#34; # Si el WAF falla, deja pasar (o \u0026#34;block\u0026#34; para m√°xima seguridad) ForwardedHeadersCustomName: \u0026#34;X-Forwarded-For\u0026#34; ForwardedHeadersTrustedIps: - \u0026#34;103.21.244.0/22\u0026#34; - \u0026#34;103.22.200.0/22\u0026#34; - \u0026#34;103.31.4.0/22\u0026#34; - \u0026#34;104.16.0.0/13\u0026#34; - \u0026#34;104.24.0.0/14\u0026#34; - \u0026#34;108.162.192.0/18\u0026#34; - \u0026#34;131.0.72.0/22\u0026#34; - \u0026#34;141.101.64.0/18\u0026#34; - \u0026#34;162.158.0.0/15\u0026#34; - \u0026#34;172.64.0.0/13\u0026#34; - \u0026#34;173.245.48.0/20\u0026#34; - \u0026#34;188.114.96.0/20\u0026#34; - \u0026#34;190.93.240.0/20\u0026#34; - \u0026#34;197.234.240.0/22\u0026#34; - \u0026#34;198.41.128.0/17\u0026#34; geoblock-es: plugin: geoblock: httpStatusCodeDeniedRequest: 404 api: \u0026#34;https://get.geojs.io/v1/ip/country/{ip}\u0026#34; # ‚Üê OBLIGATORIO ipGeolocationHttpHeaderField: \u0026#34;CF-IPCountry\u0026#34; # ‚Üê Prioriza este header! ipHeaders: [\u0026#34;X-Forwarded-For\u0026#34;, \u0026#34;CF-Connecting-IP\u0026#34;] # Backup ipHeaderStrategy: \u0026#34;CheckFirst\u0026#34; countries: # Permitir SOLO estos (ISO 3166-1 alpha-2) - ES allowLocalRequests: true # VPS/local/Tailscale allowUnknownCountries: false # Bloquea IPs sin pa√≠s apiTimeoutMs: 200 # R√°pido cacheSize: 100 # Para tu tr√°fico forwardedHeadersTrustedIps: # Cloudflare + Tailscale - \u0026#34;103.21.244.0/22\u0026#34; - \u0026#34;103.22.200.0/22\u0026#34; - \u0026#34;103.31.4.0/22\u0026#34; - \u0026#34;104.16.0.0/13\u0026#34; - \u0026#34;104.24.0.0/14\u0026#34; - \u0026#34;108.162.192.0/18\u0026#34; - \u0026#34;131.0.72.0/22\u0026#34; - \u0026#34;141.101.64.0/18\u0026#34; - \u0026#34;162.158.0.0/15\u0026#34; - \u0026#34;172.64.0.0/13\u0026#34; - \u0026#34;173.245.48.0/20\u0026#34; - \u0026#34;188.114.96.0/20\u0026#34; - \u0026#34;190.93.240.0/20\u0026#34; - \u0026#34;197.234.240.0/22\u0026#34; - \u0026#34;198.41.128.0/17\u0026#34; Cuando arranquemos por primera vez el stack crowdsec no funcionar√° porque no hemos creado el bouncer de traefik:\ndocker exec -it crowdsec cscli bouncers add traefik-bouncer Este comando nos genera una API Key que tenemos que copiar en el fichero middlewares.yml:\ncrowdsec-bouncer: plugin: crowdsec-bouncer: Enabled: true CrowdsecMode: live # o streaming si prefieres # Identidad fija para evitar los \u0026#34;bouncers fantasmas\u0026#34; bouncerName: \u0026#34;traefik-bouncer\u0026#34; # Conexi√≥n a la LAPI (Local API) CrowdsecLapiUrl: \u0026#34;http://crowdsec:8080\u0026#34; CrowdsecLapiKey: \u0026#34;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\u0026#34; \u0026lt;\u0026lt;--COPIAR AQUI EL API KEY # Configuraci√≥n del WAF (AppSec) appsecEnabled: true Reiniciamos nuestro compose:\ndocker compose restart Fichero de ejemplo de un servicio: karakeep.yml:\nhttp: routers: karakeep: rule: \u0026#34;Host(`karakeep.midominio.com`)\u0026#34; service: karakeep entryPoints: - websecure tls: certResolver: letsencrypt services: karakeep: loadBalancer: servers: - url: \u0026#34;http://100.105.100.10:3333\u0026#34; Script para creaci√≥n de servicios:\nservice=\u0026#34;my_servicio\u0026#34; url=\u0026#34;http://100.105.100.10:3333\u0026#34; cat \u0026lt;\u0026lt; EOF \u0026gt; \u0026#34;./data/conf.d/${service}.yml\u0026#34; http: routers: ${service}: rule: \u0026#34;Host(\\`${service}.midominio.com\\`)\u0026#34; service: ${service} entryPoints: - websecure tls: certResolver: letsencrypt # middlewares: # - crowdsec-bouncer # - security-headers # - geoblock-es services: ${service}: loadBalancer: servers: - url: \u0026#34;${url}\u0026#34; EOF NOTA: En el fichero traefik.yml ya le indicamos a traefik que todo el tr√°fico que entre por 443 pase por los siguientes middlewares:\nwebsecure: address: \u0026#34;:443\u0026#34; http: tls: certResolver: letsencrypt # certResolver: letsencrypt_staging middlewares: - geoblock-es - crowdsec-bouncer - security-headers En nuestro script de creaci√≥n de servicios no es necesario a√±adir los middlewares porque traefik se lo a√±ade a todos de forma general, por eso est√° comentado en el script.\nFicheros de configuraci√≥n de crowdsec Fichero obtenci√≥n datos /traefik-crowdsec/crowdsec/config/acquis.yaml:\n--- filenames: - /var/log/traefik/access.log poll_without_inotify: true labels: type: traefik Fichero definir baneos y tipo de notificaciones /traefik-crowdsec/crowdsec/config/profiles.yaml:\nname: default_ip_remediation #debug: true filters: - Alert.Remediation == true \u0026amp;\u0026amp; Alert.GetScope() == \u0026#34;Ip\u0026#34; decisions: - type: ban duration: 4h notifications: - telegram #duration_expr: Sprintf(\u0026#39;%dh\u0026#39;, (GetDecisionsCount(Alert.GetValue()) + 1) * 4) # notifications: # - slack_default # Set the webhook in /etc/crowdsec/notifications/slack.y\u0026gt; # - splunk_default # Set the splunk url and token in /etc/crowdsec/notifica\u0026gt; # - http_default # Set the required http parameters in /etc/crowdsec/noti\u0026gt; # - email_default # Set the required email parameters in /etc/crowdsec/not\u0026gt; on_success: break --- name: default_range_remediation #debug: true filters: - Alert.Remediation == true \u0026amp;\u0026amp; Alert.GetScope() == \u0026#34;Range\u0026#34; decisions: - type: ban duration: 4h #duration_expr: Sprintf(\u0026#39;%dh\u0026#39;, (GetDecisionsCount(Alert.GetValue()) + 1) * 4) # notifications: # - slack_default # Set the webhook in /etc/crowdsec/notifications/slack.y\u0026gt; # - splunk_default # Set the splunk url and token in /etc/crowdsec/notifica\u0026gt; # - http_default # Set the required http parameters in /etc/crowdsec/noti\u0026gt; # - email_default # Set the required email parameters in /etc/crowdsec/not\u0026gt; on_success: break Fichero notificaciones traefik-crowdsec/crowdsec/config/notifications/http.yaml:\ntype: http # Don\u0026#39;t change name: telegram # Must match the registered plugin in the profile # One of \u0026#34;trace\u0026#34;, \u0026#34;debug\u0026#34;, \u0026#34;info\u0026#34;, \u0026#34;warn\u0026#34;, \u0026#34;error\u0026#34;, \u0026#34;off\u0026#34; log_level: info format: | { \u0026#34;chat_id\u0026#34;: \u0026#34;-XXXXXXXXXXXXXXXX\u0026#34;, \u0026#34;text\u0026#34;: \u0026#34; {{range . -}} {{$alert := . -}} {{range .Decisions -}} üö® CrowdSec Alert on Piensa! üö® üÜî IP: {{.Value}} ‚ö†Ô∏è Scenario: {{ .Scenario }} üöß Decision: {{.Type}} for next {{.Duration}} {{end -}} {{end -}} \u0026#34;, \u0026#34;reply_markup\u0026#34;: { \u0026#34;inline_keyboard\u0026#34;: [ {{ $arrLength := len . -}} {{ range $i, $value := . -}} {{ $V := $value.Source.Value -}} [ { \u0026#34;text\u0026#34;: \u0026#34;See {{ $V }} on shodan.io\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.shodan.io/host/{{ $V -}}\u0026#34; }, { \u0026#34;text\u0026#34;: \u0026#34;See {{ $V }} on crowdsec.net\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://app.crowdsec.net/cti/{{ $V -}}\u0026#34; } ]{{if lt $i ( sub $arrLength 1) }},{{end }} {{end -}} ] } url: https://api.telegram.org/bot111111111111:XXXXXXXXXx-XXXXXXXXXXXXXXXXXXXXXXXXX/sendMessage method: POST headers: Content-Type: \u0026#34;application/json\u0026#34; En este momento podemos arrancar nuestro compose y deber√≠a funcionar todo correctamente.\nAPPSEC para Crowdsec Seg√∫n la web de Crowdsec, Appsec es un WAF que ofrece las siguientes caracter√≠sticas:\n1.- Aplicaci√≥n de parches virtuales con bajo esfuerzo. 2.- Compatibilidad con reglas heredadas de ModSecurity. 3.- Protecci√≥n WAF cl√°sica m√°s funciones de CrowdSec para detecci√≥n avanzada de comportamiento. 4.- Integraci√≥n completa con la pila CrowdSec, incluidos la consola y los componentes de remediaci√≥n.\nPara integrarlo realizamos los siguientes pasos:\n# Detenemos nuestro stack docker compose down A√±adimos a nuestro docker-compose las colecciones:\n- COLLECTIONS=crowdsecurity/traefik crowdsecurity/http-cve crowdsecurity/appsec-virtual-patching crowdsecurity/appsec-generic-rules # Arrancamos nuevamente la pila docker compose up -d Tenemos que crear un fichero de adquisiciones para Appsec. Antes de eso debemos descargar las reglas de appsec porque sino el contenedor de crowdsec no arrancar√° (me di√≥ este problema y estuvo volviendome loco hasta encontrar una soluci√≥n por la red).\nDescargamos las reglas:\ndocker exec crowdsec cscli collections install crowdsecurity/appsec-virtual-patching docker exec crowdsec cscli collections install crowdsecurity/appsec-generic-rules Reiniciamos crowdsec:\ndocker compose restart crowdsec Ahora podemos verificar que ha arrancado correctamente sin reinicios con\ndocker stats Creamos el fichero de adquisiciones:\nsudo nano /crowdsec/config/acquis.d/appsec.yaml #A√±adimos esto al fichero: appsec_config: crowdsecurity/appsec-default labels: type: appsec listen_addr: 0.0.0.0:7422 source: appsec A√±adimos la nueva configuraci√≥n a nuestro middleware de crowdsec:\ncrowdsec-bouncer: plugin: crowdsec-bouncer: Enabled: true # CrowdsecMode: live # o streaming si prefieres crowdsecMode: live # o streaming si prefieres # Identidad fija para evitar los \u0026#34;bouncers fantasmas\u0026#34; bouncerName: \u0026#34;traefik-bouncer\u0026#34; # Conexi√≥n a la LAPI (Local API) CrowdsecLapiUrl: \u0026#34;http://crowdsec:8080\u0026#34; # crowdsecLapiHost: \u0026#34;crowdsec:8080\u0026#34; CrowdsecLapiKey: \u0026#34;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\u0026#34; # Configuraci√≥n del WAF (AppSec) crowdsecAppsecEnabled: true crowdsecAppsecHost: \u0026#34;crowdsec:7422\u0026#34; # Puerto por defecto del WAF en\u0026gt; crowdsecAppsecFailureBlock: true crowdsecAppsecUnreachableBlock: true #appsecFailureAction: \u0026#34;passthrough\u0026#34; # Si el WAF falla, deja pasar (\u0026gt; ForwardedHeadersCustomName: \u0026#34;X-Forwarded-For\u0026#34; [.................] Y reiniciamos nuevamente crowdsec:\ndocker compose restart crowdsec Verificaciones a realizar para comprobar que funciona correctamente:\ndocker exec crowdsec cscli appsec-rules list # Genera un listado de las reglas que est√°n activas: ------------------------------------------------------------------------------------------------------------------------------------------ APPSEC-RULES ------------------------------------------------------------------------------------------------------------------------------------------ Name üì¶ Status Version Local Path ------------------------------------------------------------------------------------------------------------------------------------------ crowdsecurity/appsec-generic-test ‚úîÔ∏è enabled 0.3 /etc/crowdsec/appsec-rules/appsec-generic-test.yaml crowdsecurity/base-config ‚úîÔ∏è enabled 0.1 /etc/crowdsec/appsec-rules/base-config.yaml crowdsecurity/experimental-no-user-agent ‚úîÔ∏è enabled 0.1 /etc/crowdsec/appsec-rules/experimental-no-user-agent.yaml crowdsecurity/generic-freemarker-ssti ‚úîÔ∏è enabled 0.3 /etc/crowdsec/appsec-rules/generic-freemarker-ssti.yaml docker exec crowdsec cscli metrics show appsec #Metricas de Appsec +-------------------------------------+ | Appsec Metrics | +---------------+-----------+---------+ | Appsec Engine | Processed | Blocked | +---------------+-----------+---------+ | 0.0.0.0:7422/ | 361 | - | +---------------+-----------+---------+ ‚ï∞‚îÄ docker exec crowdsec cscli appsec-configs list ---------------------------------------------------------------------------------------------------------- APPSEC-CONFIGS ---------------------------------------------------------------------------------------------------------- Name üì¶ Status Version Local Path ---------------------------------------------------------------------------------------------------------- crowdsecurity/appsec-default ‚úîÔ∏è enabled 0.4 /etc/crowdsec/appsec-configs/appsec-default.yaml crowdsecurity/generic-rules ‚úîÔ∏è enabled 0.4 /etc/crowdsec/appsec-configs/generic-rules.yaml crowdsecurity/virtual-patching ‚úîÔ∏è enabled 0.4 /etc/crowdsec/appsec-configs/virtual-patching.yaml ---------------------------------------------------------------------------------------------------------- En teor√≠a, siguiendo las ]instrucciones de crowdsec](https://docs.crowdsec.net/docs/appsec/quickstart/traefik) deber√≠amos mapear el fichero en el contenedor de docker, pero yo no lo he hecho y funciona igual:\ncrowdsec: image: crowdsecurity/crowdsec:latest container_name: crowdsec restart: unless-stopped environment: - COLLECTIONS=crowdsecurity/traefik crowdsecurity/http-cve crowdsecurity/appsec-virtual-patching crowdsecurity/appsec-generic-rules - DISABLE_CAPI=true # Ignora CAPI completamente volumes: # - ./crowdsec/config/acquis.d/appsec.yaml:/etc/crowdsec/acquis.d/appsec.yaml [......] NOTA IMPORTANTE: Por √∫ltimo, me he dado cuenta que si ya ten√≠amos funcionando el stack con configuraciones anteriores, cuando a√±adimos Appsec por lo que sea el Appsec engine se queda en blanco:\n‚ï∞‚îÄ docker exec crowdsec cscli metrics show appsec +-------------------------------------+ | Appsec Metrics | +---------------+-----------+---------+ | Appsec Engine | Processed | Blocked | +---------------+-----------+---------+ | | | - | +---------------+-----------+---------+ y tengo que borrar toda la configuraci√≥n de crowdsec y volver a empezar. Con eso ya funciona correctamente. Supongo que algo se queda en cach√©.\n‚ï∞‚îÄ docker exec crowdsec cscli metrics show appsec +-------------------------------------+ | Appsec Metrics | +---------------+-----------+---------+ | Appsec Engine | Processed | Blocked | +---------------+-----------+---------+ | 0.0.0.0:7422/ | 4 | - | +---------------+-----------+---------+ EXTRA: Ampliar la capacidad de RAM de nuestro VPS con swap Nuestro VPS est√° muy escaso de RAM. Vamos a darle algo de margen aprovechando nuestro nvme y creando una swap de 1GB de tama√±o.\nCreaci√≥n de nuestro fichero swap:\nsudo fallocate -l 1G /swapfile ls -la / sudo chmod 600 /swapfile sudo mkswap /swapfile sudo swapon /swapfile echo \u0026#39;/swapfile none swap sw 0 0\u0026#39; | sudo tee -a /etc/fstab cat /etc/fstab free -h sudo sysctl vm.swappiness=20 htop Fuentes y enlaces de inter√©s que ayudaran a complementar esta gu√≠a:\nInstalaci√≥n de traefik sin etiquetas Crowdsec WAF - Appsec\n","permalink":"https://blog.lasnotasdenoah.com/posts/vps-proxy/","summary":"\u003ch2 id=\"traefik-y-crowdsec\"\u003eTraefik y crowdsec\u003c/h2\u003e\n\u003cp\u003eEstoy hasta el gorro de la liga y sus pu√±eteros bloqueos.  Este blog y mis servicios estaban configurados en el NAS con un traefik como proxy inverso. Para proteger mi IP p√∫blica uso el Proxied de cloudflare, que adem√°s aporta un WAF muy potente, geolocalizaci√≥n, etc. \u003cstrong\u003ePROBLEMA\u003c/strong\u003e: cada vez que hay futbol pierdo la conexi√≥n a homeassistant y otros servicios que para mi son muy importantes.\u003c/p\u003e\n\u003cp\u003eHoy vamos a configurar traefik en un VPS y desde all√≠ enrutamos todo el tr√°fico a nuestro NAS local a trav√©s de Tailscale.  Desactivaremos el proxied de cloudflare y de esta forma no est√° expuesta mi IP p√∫blica, s√≥lo est√° expuesta la IP del VPS.\u003cbr\u003e\nHe contratado el VPS m√°s econ√≥mico que tiene \u003ca href=\"https://www.piensasolutions.com/\"\u003ePiensasolutions\u003c/a\u003e. En mi caso pago 0,75‚Ç¨ al mes durante 12 meses y despu√©s el coste pasa a ser 1‚Ç¨ al mes.\u003cbr\u003e\nEl VPS tiene 1 GB de RAM, 1 vCPU, 10GB SSD NVMe y conexi√≥n de 1Gbps.\u003cbr\u003e\nAl principio intent√© instalar Pangol√≠n, que ya lo tuve operativo en un VPS de prueba m√°s potente. Pero creo que en este servidor es muy exigente y no puede para nada con √©l. Solo Pangol√≠n consume 300 Mb de RAM m√°s el sistema, crowdsec, etc. IMPOSIBLE !!!!!\u003c/p\u003e","title":"Proxy Inverso en VPS"},{"content":"Traefik y crowdsec Hasta hace poco ten√≠a en funcionamiento traefik con crowdsec usando las plantillas de unraid. Hice varios manuales sobre la instalaci√≥n pero por motivos que desconozco crowdsec no parseaba las l√≠neas de logs de traefik y por tanto no hac√≠a absolutamente nada.\nHe decicido hacer una instalaci√≥n limpia desde 0 y aqu√≠ va.\nGran parte de este manual se ha hecho usando Perplexity. Debo decir que tiene mucho que mejorar, pero nos marca unas bases buenas para empezar.\nPreparaci√≥n del entorno Lo primero que vamos a hacer es preparar nuestro entorno de directorios:\nDirectorios de traefik y crowdsec:\nmkdir -p /mnt/user/appdata/traefik/{letsencrypt,log} mkdir -p /mnt/user/appdata/crowdsec/data Ficheros de configuraci√≥n y logs de traefik:\ntouch /mnt/user/appdata/traefik/letsencrypt/acme.json chmod 600 /mnt/user/appdata/traefik/letsencrypt/acme.json touch /mnt/user/appdata/traefik/traefik.yml touch /mnt/user/appdata/traefik/dynamic_conf.yml touch /mnt/user/appdata/traefik/log/access.log chmod 644 /mnt/user/appdata/traefik/log/access.log Fichero de configuraci√≥n de crowdsec. Dentro de la carpeta de configuraci√≥n de crowdsec creamos el fichero acquis.yaml:\ntouch /mnt/user/appdata/crowdsec/config/acquis.yaml Docker-compose Sigo usando Unraid. Nos vamos a la pesta√±a compose y creamos nuestro stack de docker:\ndocker-compose.yml\nservices: traefik: image: traefik:v3.0 container_name: traefik restart: unless-stopped security_opt: - no-new-privileges:true ports: - \u0026#34;1880:80\u0026#34; - \u0026#34;18443:443\u0026#34; environment: - CF_DNS_API_TOKEN=${CF_DNS_API_TOKEN} # API TOKEN DE CLOUDFLARE volumes: - /var/run/docker.sock:/var/run/docker.sock:ro - /mnt/user/appdata/traefik/letsencrypt/acme.json:/letsencrypt/acme.json - /mnt/user/appdata/traefik/traefik.yml:/etc/traefik/traefik.yml:ro - /mnt/user/appdata/traefik/dynamic_conf.yml:/etc/traefik/dynamic_conf.yml:ro - /mnt/user/appdata/traefik/log:/var/log/traefik # Volumen para persistencia de logs networks: - cloud crowdsec: image: crowdsecurity/crowdsec container_name: crowdsec restart: unless-stopped environment: - COLLECTIONS=crowdsecurity/traefik crowdsecurity/http-cve volumes: - /mnt/user/appdata/traefik/log:/var/log/traefik:ro # comparte los logs - /mnt/user/appdata/crowdsec/data:/var/lib/crowdsec/data - /mnt/user/appdata/crowdsec/config:/etc/crowdsec networks: - cloud networks: cloud: external: true Fichero .env\nCF_DNS_API_TOKEN=MI_API_KEY_CLOUDFLARE. # Se obtiene en el panel de cloudflare CROWDSEC_BOUNCER_API_KEY= xxxxxxxx # Con la √∫ltima versi√≥n del docker-compose se puede borrar DOMAIN_NAME=mi_dominio.com # Con la √∫ltima versi√≥n del docker-compose se puede borrar EMAIL=mi_correo@hotmail.com # Con la √∫ltima versi√≥n del docker-compose se puede borrar Nota Importante: ES IMPRESCINDIBLE QUE LOS SERVICIOS QUE USEMOS CON TRAEFIK EST√âN EN LA MISMA RED DOCKER. En mi caso se llama cloud\nFicheros de configuraci√≥n Traefik - traefik.yml\napi: dashboard: false # Cuando necesito revisar el dashboard lo cambio a true y reinicio el contenedor. Mientras no sea necesario lo dejo en false. providers: docker: exposedByDefault: false network: cloud # Debe coincidir con el nombre de tu red externa en docker-compose file: fileName: /etc/traefik/dynamic_conf.yml watch: true entryPoints: web: address: \u0026#34;:80\u0026#34; http: redirections: entryPoint: to: websecure scheme: https websecure: address: \u0026#34;:443\u0026#34; transport: respondingTimeouts: idleTimeout: 3600 # 1. HABILITAR LOGS (Vital para que CrowdSec detecte ataques) accessLog: filePath: \u0026#34;/var/log/traefik/access.log\u0026#34; format: json bufferingSize: 100 fields: headers: defaultMode: keep # Mantiene headers para que CrowdSec vea IPs reales # 2. PLUGINS (CrowdSec Bouncer para Traefik v3) # # AQUI A√ëADIREMOS EL PLUGIN DE CROWDSEC # # 3. CONFIGURACI√ìN DE CERTIFICADOS (Cloudflare DNS Challenge) certificatesResolvers: cloudflare: acme: email: mi_correo@hotmail.com storage: /letsencrypt/acme.json dnsChallenge: provider: cloudflare resolvers: - \u0026#34;1.1.1.1:53\u0026#34; - \u0026#34;8.8.8.8:53\u0026#34; Traefik - dynamic_conf.yml\nhttp: routers: dashboard: rule: \u0026#34;Host(`traefik.mi_dominio.com`)\u0026#34; service: api@internal entryPoints: - websecure tls: certResolver: cloudflare middlewares: - auth - security-headers middlewares: auth: basicAuth: # Generar con: echo $(htpasswd -nB usuario) | sed -e s/\\\\$/\\\\$\\\\$/g users: - \u0026#34;noah:$mi_pass_hasheada\u0026#34; security-headers: headers: stsSeconds: 15552000 stsIncludeSubdomains: true stsPreload: true forceSTSHeader: true frameDeny: true # Previene Clickjacking contentTypeNosniff: true # Previene sniffing de MIME browserXssFilter: true referrerPolicy: \u0026#34;same-origin\u0026#34; # Ajuste para Nextcloud: customFrameOptionsValue: \u0026#34;SAMEORIGIN\u0026#34; # # AQUI A√ëADIREMOS EL MIDDLEWARE DE CROWDSEC # Crowdsec - acquis.yaml\n--- filenames: - /var/log/traefik/access.log poll_without_inotify: true labels: type: traefik Integraci√≥n del bouncer en traefik Iniciamos nuestro compose y no deber√≠a lanzar errores.\nEs momento de crear nuestra API key del bouncer crowdsec:\n--- docker exec -it crowdsec cscli bouncers add traefik-bouncer # te devolver√° una API key, gu√°rdala Verificamos que nuestras colecciones est√©n actualizadas:\ndocker exec -it crowdsec cscli hub update docker exec -it crowdsec cscli hub upgrade docker restart crowdsec Modificamos nuestros ficheros traefik.yml y dynamic_conf.yml para a√±adir lo siguente:\nTraefik - traefik.yml\nexperimental: plugins: crowdsec-bouncer: moduleName: github.com/maxlerebourg/crowdsec-bouncer-traefik-plugin version: v1.3.5 Traefik - dynamic_conf.yml\nmiddlewares: [...AQUI TENEMOS NUESTROS OTROS MIDDLEWARES......] crowdsec-bouncer: plugin: crowdsec-bouncer: Enabled: true CrowdsecMode: live # o streaming si prefieres CrowdsecLapiUrl: \u0026#34;http://crowdsec:8080\u0026#34; CrowdsecLapiKey: \u0026#34;ESTA KEY SE GENERA MAS ADELANTE\u0026#34; ForwardedHeadersCustomName: \u0026#34;X-Forwarded-For\u0026#34; # Obtenemos la lista oficial de IPs con el siguiente comando: # curl https://www.cloudflare.com/ips-v4 -o cloudflare-ips-v4.txt ForwardedHeadersTrustedIps: - \u0026#34;103.21.244.0/22\u0026#34; - \u0026#34;103.22.200.0/22\u0026#34; - \u0026#34;103.31.4.0/22\u0026#34; - \u0026#34;104.16.0.0/13\u0026#34; - \u0026#34;104.24.0.0/14\u0026#34; - \u0026#34;108.162.192.0/18\u0026#34; - \u0026#34;131.0.72.0/22\u0026#34; - \u0026#34;141.101.64.0/18\u0026#34; - \u0026#34;162.158.0.0/15\u0026#34; - \u0026#34;172.64.0.0/13\u0026#34; - \u0026#34;173.245.48.0/20\u0026#34; - \u0026#34;188.114.96.0/20\u0026#34; - \u0026#34;190.93.240.0/20\u0026#34; - \u0026#34;197.234.240.0/22\u0026#34; - \u0026#34;198.41.128.0/17\u0026#34; Ficheros completos:\nTraefik - traefik.yml\napi: dashboard: false # Cuando necesito revisar el dashboard lo cambio a true y reinicio el contenedor. Mientras no sea necesario lo dejo en false. providers: docker: exposedByDefault: false network: cloud # Debe coincidir con el nombre de tu red externa en docker-compose file: fileName: /etc/traefik/dynamic_conf.yml watch: true entryPoints: web: address: \u0026#34;:80\u0026#34; http: redirections: entryPoint: to: websecure scheme: https websecure: address: \u0026#34;:443\u0026#34; transport: respondingTimeouts: idleTimeout: 3600 # 1. HABILITAR LOGS (Vital para que CrowdSec detecte ataques) accessLog: filePath: \u0026#34;/var/log/traefik/access.log\u0026#34; format: json bufferingSize: 100 fields: headers: defaultMode: keep # Mantiene headers para que CrowdSec vea IPs reales # 2. PLUGINS (CrowdSec Bouncer para Traefik v3) experimental: plugins: crowdsec-bouncer: moduleName: github.com/maxlerebourg/crowdsec-bouncer-traefik-plugin version: v1.3.5 # 3. CONFIGURACI√ìN DE CERTIFICADOS (Cloudflare DNS Challenge) certificatesResolvers: cloudflare: acme: email: mi_correo@hotmail.com storage: /letsencrypt/acme.json dnsChallenge: provider: cloudflare resolvers: - \u0026#34;1.1.1.1:53\u0026#34; - \u0026#34;8.8.8.8:53\u0026#34; Traefik - dynamic_conf.yml\nhttp: routers: dashboard: rule: \u0026#34;Host(`traefik.mi_dominio.com`)\u0026#34; service: api@internal entryPoints: - websecure tls: certResolver: cloudflare middlewares: - auth - security-headers - crowdsec-bouncer # Protegemos el dashboard con crowdsec middlewares: auth: basicAuth: # Generar con: echo $(htpasswd -nB usuario) | sed -e s/\\\\$/\\\\$\\\\$/g users: - \u0026#34;noah:$mi_pass_hasheada\u0026#34; security-headers: headers: stsSeconds: 15552000 stsIncludeSubdomains: true stsPreload: true forceSTSHeader: true frameDeny: true # Previene Clickjacking contentTypeNosniff: true # Previene sniffing de MIME browserXssFilter: true referrerPolicy: \u0026#34;same-origin\u0026#34; # Ajuste para Nextcloud: customFrameOptionsValue: \u0026#34;SAMEORIGIN\u0026#34; crowdsec-bouncer: plugin: crowdsec-bouncer: Enabled: true CrowdsecMode: live # o streaming si prefieres CrowdsecLapiUrl: \u0026#34;http://crowdsec:8080\u0026#34; CrowdsecLapiKey: \u0026#34;zEtyY2gJsQgQca03vEvWWwcowSG8f9yJz84nF95qZq4\u0026#34; ForwardedHeadersCustomName: \u0026#34;X-Forwarded-For\u0026#34; ForwardedHeadersTrustedIps: - \u0026#34;103.21.244.0/22\u0026#34; - \u0026#34;103.22.200.0/22\u0026#34; - \u0026#34;103.31.4.0/22\u0026#34; - \u0026#34;104.16.0.0/13\u0026#34; - \u0026#34;104.24.0.0/14\u0026#34; - \u0026#34;108.162.192.0/18\u0026#34; - \u0026#34;131.0.72.0/22\u0026#34; - \u0026#34;141.101.64.0/18\u0026#34; - \u0026#34;162.158.0.0/15\u0026#34; - \u0026#34;172.64.0.0/13\u0026#34; - \u0026#34;173.245.48.0/20\u0026#34; - \u0026#34;188.114.96.0/20\u0026#34; - \u0026#34;190.93.240.0/20\u0026#34; - \u0026#34;197.234.240.0/22\u0026#34; - \u0026#34;198.41.128.0/17\u0026#34; Obtener las IPs confiables de cloudflare Para configurar ForwardedHeadersTrustedIps con precisi√≥n en el middleware de CrowdSec, se usan las IPs de Cloudflare. Esto evita que IPs falsas se usen para evadir bloqueos.\n‚Äã Lista oficial de IPs de Cloudflare.\nCloudflare publica sus rangos IPv4/IPv6 en dos archivos JSON. Los podemos obetner as√≠\n# Desde la terminal de Unraid (donde corre Docker) curl https://www.cloudflare.com/ips-v4 -o cloudflare-ips-v4.txt curl https://www.cloudflare.com/ips-v6 -o cloudflare-ips-v6.txt Las IPs que obtenemos las a√±adimos al fichero dynamic_conf.yml, apartado ForwardedHeadersTrustedIps del middleware crowdsec-bouncer.\nPuesta en marcha y comprobaci√≥n Con todo esto reiniciamos el stack de docker y deber√≠a arrancar funcionando sin errores. Revisaremos los logs para verificar fallos.\ndocker compose down docker compose up -d # En Unraid lo hacemos de forma gr√°fica docker logs traefik | grep -i crowdsec docker logs crowdsec docker exec crowdsec cscli decisions list Comandos intersantes de crowdsec:\n# Listado de decisiones tomadas docker exec -it crowdsec cscli decisions list # M√©tricas completas de crowdsec docker exec -it crowdsec cscli metrics # Unban IP docker exec -it crowdsec cscli decisions delete -i x.x.x.x # Banear una IP docker exec -it crowdsec cscli decisions add --ip xx.xx.xx.xx --duration 1h Enrutar servicios a trav√©s de traefik Las etiquetas b√°sicas que debe llevar cualquier servicio para que traefik lo enrute son las siguientes:\n# Ejemplo para nuestro karakeep traefik.enable=true traefik.http.routers.karakeep.rule=Host(`karakeep.mi_dominio.com`) traefik.http.routers.karakeep.entrypoints=websecure traefik.http.routers.karakeep.tls.certresolver=cloudflare traefik.http.services.karakeep.loadbalancer.server.port=3000 # middelware que vamos a aplicar a este servcio traefik.http.routers.karakeep.middlewares=crowdsec-bouncer@file,security-headers@file IMPORTANTE: La etiqueta traefik.http.services.karakeep.loadbalancer.server.port debe indicar el puerto interno del contenedor, ya que tenemos que recordar que nuestros servicios siempre deben estar en la misma red que traefik para que funcionen.\nEn mi caso, el docker-compose de karakeep lleva la siguiente configuraci√≥n de puertos porque el puerto 3000 lo estoy usando para otro servicio:\n[....] ports: - 3333:3000 [....] Entonces, el acceso a karakeep a trav√©s de la red local es:\nhttp://192.168.10.55:3333\nPero traefik s√≥lo entiende de la red docker, por lo que el puerto para traefik es 3000.\nProtecci√≥n de servicios con crowdsec Hemos configurado crowdsec como un middleware, por tanto, la solicitud de conexi√≥n al servicio debe pasar antes por crowdsec que dir√° si permite esa conexi√≥n o no.\nPara proteger servicios tenemos dos opciones:\n1.- Configuraci√≥n est√°tica en dynamic_conf.yml\n2.- Etiquetas traefik en el servicio en cuesti√≥n.\nPor facilidad vamos a hacer la segunda opci√≥n, a trav√©s de etiquetas, as√≠ mantenemos m√°s limpio el dynamic_conf.yml y traefik hace una carga en vivo sin reiniciar el proxy.\nEtiqueta:\n# Ejemplo para Nextcloud. El resto de servicios ser√≠a exactamente igual traefik.http.routers.nextcloud.middlewares=rowdsec-bouncer@file,security-headers@file Protecci√≥n de Nextcloud Crowdsec tiene una colecci√≥n espec√≠fica para Nextcloud. Vamos a proteger nuestra instancia.\nModificamos el docker-compose a√±adiendo la colecci√≥n de crowdsecurity/nextcloud y montando la carpeta donde almacenamos los logs de Nextcloud.\ncrowdsec: image: crowdsecurity/crowdsec container_name: crowdsec restart: unless-stopped environment: - COLLECTIONS=crowdsecurity/traefik crowdsecurity/http-cve crowdsecurity/nextcloud volumes: - /mnt/user/appdata/traefik/log:/var/log/traefik:ro # comparte los logs - /mnt/user/appdata/nextcloud/config/nextcloud-logs:/var/log/nextcloud:ro # comparte los logs Reiniciamos crowdsec y podemos actualizar las colletions:\ndocker exec -it crowdsec cscli hub update Revisamos nuestro config.php de Nextcloud para verificar que los logs se guardan en el lugar correcto:\n\u0026#39;mail_smtpport\u0026#39; =\u0026gt; \u0026#39;465\u0026#39;, \u0026#39;bulkupload.enabled\u0026#39; =\u0026gt; false, \u0026#39;loglevel\u0026#39; =\u0026gt; 2, \u0026#39;logfile\u0026#39; =\u0026gt; \u0026#39;/var/www/html/config/nextcloud-logs/nextcloud.log\u0026#39;, \u0026#39;log_rotate_size = 0\u0026#39;, Modificamos nuestro fichero acquis.yaml de crowdsec, quedano as√≠:\n# Logs de Traefik (para todo lo que pasa por el proxy) --- filenames: - /var/log/traefik/access.log poll_without_inotify: true labels: type: traefik # Logs de Nextcloud (brute-force y eventos espec√≠ficos NC) --- filenames: - /var/log/nextcloud/nextcloud.log labels: type: nextcloud Reiniciamos y verificamos si se est√°n parseando los dos ficheros de logs que tenemos:\ndocker restart crowdsec docker exec crowdsec cscli metrics # Verifica parsing Con esta configuraci√≥n Nextcloud registraba la direcci√≥n IP de Cloudflare, no la IP real del usuario que accede a Nextcloud. Vamos a arreglarlo.\nProblema cl√°sico Cloudflare + Traefik + Nextcloud: Nextcloud ve IP de Cloudflare porque no conf√≠a en Traefik como proxy ni lee el header CF-Connecting-IP (IP real que pasa Cloudflare).\nEditamos nuestro fichero config.php de Nextcloud:\n[.......] \u0026#39;dbtype\u0026#39; =\u0026gt; \u0026#39;mysql\u0026#39;, \u0026#39;version\u0026#39; =\u0026gt; \u0026#39;32.0.5.0\u0026#39;, \u0026#39;trusted_proxies\u0026#39; =\u0026gt; array ( 0 =\u0026gt; \u0026#39;192.168.10.55\u0026#39;, // a√±adida rango IP de nuestra red \u0026#34;cloud\u0026#34; de docker: 1 =\u0026gt; \u0026#39;172.21.0.0/16\u0026#39;, // a√±adidas IPs de clouflare para que Nextcloud conf√≠e en ellas: 2 =\u0026gt; \u0026#39;103.21.244.0/22\u0026#39;, 3 =\u0026gt; \u0026#39;103.22.200.0/22\u0026#39;, 4 =\u0026gt; \u0026#39;103.31.4.0/22\u0026#39;, 5 =\u0026gt; \u0026#39;104.16.0.0/13\u0026#39;, 6 =\u0026gt; \u0026#39;104.24.0.0/14\u0026#39;, 7 =\u0026gt; \u0026#39;108.162.192.0/18\u0026#39;, 8 =\u0026gt; \u0026#39;131.0.72.0/22\u0026#39;, 9 =\u0026gt; \u0026#39;141.101.64.0/18\u0026#39;, 10 =\u0026gt; \u0026#39;162.158.0.0/15\u0026#39;, 11 =\u0026gt; \u0026#39;172.64.0.0/13\u0026#39;, 12 =\u0026gt; \u0026#39;173.245.48.0/20\u0026#39;, 13 =\u0026gt; \u0026#39;188.114.96.0/20\u0026#39;, 14 =\u0026gt; \u0026#39;190.93.240.0/20\u0026#39;, 15 =\u0026gt; \u0026#39;197.234.240.0/22\u0026#39;, 16 =\u0026gt; \u0026#39;198.41.128.0/17\u0026#39;, ), // a√±adida seg√∫n info de perplexity para que crowdsec funcione bien. \u0026#39;forwarded_for_headers\u0026#39; =\u0026gt; array ( \u0026#39;HTTP_CF_CONNECTING_IP\u0026#39;, // ‚Üê IP real de Cloudflare \u0026#39;HTTP_X_FORWARDED_FOR\u0026#39;, \u0026#39;HTTP_X_FORWARDED\u0026#39;, \u0026#39;HTTP_X_CLUSTER_CLIENT_IP\u0026#39;, \u0026#39;HTTP_FORWARDED_FOR\u0026#39;, \u0026#39;HTTP_FORWARDED\u0026#39;, \u0026#39;REMOTE_ADDR\u0026#39;, ), \u0026#39;overwrite.cli.url\u0026#39; =\u0026gt; \u0026#39;https://nextcloud.mi_dominio.com\u0026#39;, \u0026#39;overwritehost\u0026#39; =\u0026gt; \u0026#39;nextcloud.mi_dominio.com\u0026#39;, [......] Y a√±adimos las siguientes etiquetas al docker-compose de Nextcloud:\n# Esta primera la editamos como sigue: traefik.http.routers.nextcloud.middlewares=crowdsec-bouncer@file,security-headers@file,nextcloud-headers@docker # Estas se a√±aden nuevas: traefik.http.middlewares.nextcloud-headers.headers.customrequestheaders.X-Forwarded-Proto=https traefik.http.middlewares.nextcloud-headers.headers.customrequestheaders.X-Forwarded-For=true traefik.http.middlewares.nextcloud-headers.headers.customrequestheaders.X-Forwarded-Port=443 traefik.http.middlewares.nextcloud-headers.headers.customrequestheaders.X-Real-IP={{.ClientIP }} Y con esto nuestro Nextcloud ya detecta la IP verdadera para, si procede, banearla.\nConexi√≥n de nuestro contenedor a Crowdsec.net Accedemos a nuestra cuenta en https://app.crowdsec.net/.\nEn el dashboard ‚Üí Security Engines ‚Üí Add Instance (o \u0026ldquo;Engines\u0026rdquo;)\nCopia el Enrollment Token que genera (algo como cscli console enroll abc123\u0026hellip;def456)\n# Registrar con el token docker exec -it crowdsec cscli console enroll TU_ENROLLMENT_TOKEN_AQUI Esto crear√° /etc/crowdsec/online_api_credentials.yaml con login y password v√°lidos.\nReiniciamos nuestro contenedor:\ndocker restart crowdsec docker logs crowdsec | grep -i capi Volvemos al dashboard de crowdsec.net y aceptamos el enrolado del equipo. Podemos cambiar el nombre para ser m√°s visual al acceder. En mi caso le puse Unraid.\nVentajas de conectar a Console:\n1.- Dashboard web con alertas en tiempo real\n2.- Blocklist comunitaria (millones de IPs malas)\n3.- M√©tricas globales y threat intel\n**En mi caso, al final no hice el enrolado del equipo por los siguientes motivos:\nNotificaciones en Telegram de Crowdsec Para a√±adir notificaciones realizamos la siguiente configuraci√≥n:\nIMPORTANTE: DETENEMOS EL COMPOSE\nFichero /mnt/user/appdata/crowdsec/config/notifications/http.yaml\ntype: http # No cambiar name: telegram # Nombre que usaremos en el perfil log_level: info # URL de la API de Telegram con tu TOKEN # Mucho OJO en la url - Est√° bien escrita url: https://api.telegram.org/botXXXXXXXXXXXX:XXXXXXXXXXXXXXXXXXXXXX_XXXXXXXXXXXXXXXX/sendMessage method: POST headers: Content-Type: application/json # Formato del mensaje (JSON) # Formato del mensaje (JSON) format: | { \u0026#34;chat_id\u0026#34;: \u0026#34;-5002897396\u0026#34;, \u0026#34;text\u0026#34;: \u0026#34;{{range .}}{{$alert := .}}{{range .Decisions}}IP {{.Value}} baneada {{.Duration}} por {{.Scenario}}{{end}}{{end}}\u0026#34;, \u0026#34;parse_mode\u0026#34;: \u0026#34;HTML\u0026#34; } Fichero /mnt/user/appdata/crowdsec/config/profiles.yaml\nname: default_ip_remediation #debug: true filters: - Alert.Remediation == true \u0026amp;\u0026amp; Alert.GetScope() == \u0026#34;Ip\u0026#34; decisions: - type: ban duration: 4h notifications: - telegram Probamos a enviar una notificaci√≥n de prueba:\ndocker exec -it crowdsec cscli notifications test telegram Versi√≥n tuneada de notificaciones en Telegram. Tomando como ejemplo el modelo de la documentaci√≥n de crowdsec.net:\ntype: http # Don\u0026#39;t change name: telegram # Must match the registered plugin in the profile # One of \u0026#34;trace\u0026#34;, \u0026#34;debug\u0026#34;, \u0026#34;info\u0026#34;, \u0026#34;warn\u0026#34;, \u0026#34;error\u0026#34;, \u0026#34;off\u0026#34; log_level: info format: | { \u0026#34;chat_id\u0026#34;: \u0026#34;-5002897396\u0026#34;, \u0026#34;text\u0026#34;: \u0026#34; {{range . -}} {{$alert := . -}} {{range .Decisions -}} üö® CrowdSec Alert on MyServer! üö® üÜî IP: {{.Value}} ‚ö†Ô∏è Scenario: {{ .Scenario }} üöß Decision: {{.Type}} for next {{.Duration}} {{end -}} {{end -}} \u0026#34;, \u0026#34;reply_markup\u0026#34;: { \u0026#34;inline_keyboard\u0026#34;: [ {{ $arrLength := len . -}} {{ range $i, $value := . -}} {{ $V := $value.Source.Value -}} [ { \u0026#34;text\u0026#34;: \u0026#34;See {{ $V }} on shodan.io\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.shodan.io/host/{{ $V -}}\u0026#34; }, { \u0026#34;text\u0026#34;: \u0026#34;See {{ $V }} on crowdsec.net\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://app.crowdsec.net/cti/{{ $V -}}\u0026#34; } ]{{if lt $i ( sub $arrLength 1) }},{{end }} {{end -}} ] } url: https://api.telegram.org/botXXXXXXXXXXX:XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX/sendMessage method: POST headers: Content-Type: \u0026#34;application/json\u0026#34; Fuentes y enlaces de inter√©s que ayudaran a complementar esta gu√≠a:\nTraefik Crowdsec\n","permalink":"https://blog.lasnotasdenoah.com/posts/traefik/","summary":"\u003ch2 id=\"traefik-y-crowdsec\"\u003eTraefik y crowdsec\u003c/h2\u003e\n\u003cp\u003eHasta hace poco ten√≠a en funcionamiento traefik con crowdsec usando las plantillas de unraid. Hice varios manuales sobre la instalaci√≥n pero por motivos que desconozco crowdsec no parseaba las l√≠neas de logs de traefik y por tanto no hac√≠a absolutamente nada.\u003cbr\u003e\nHe decicido hacer una instalaci√≥n limpia desde 0 y aqu√≠ va.\u003cbr\u003e\nGran parte de este manual se ha hecho usando \u003ca href=\"https://www.perplexity.ai/\"\u003ePerplexity\u003c/a\u003e. Debo decir que tiene mucho que mejorar, pero nos marca unas bases buenas para empezar.\u003c/p\u003e","title":"Traefik v3 y Crowdsec"},{"content":"Configuraci√≥n de Backups con Borg Nuestro servidor de Unraid va a servir para guardar los backups de nuestras m√°quinas. En concreto vamos a guardar los backups de los equipos (port√°tiles y m√≥viles) a trav√©s de Vorta, del VPS y del servidor Debian sanMi.\nEsta necesidad ha surgido por dos temas distintos:\nEl primero es la necesidad de hacer backup de nuestros servidores secundarios. Podr√≠a instalar Duplicacy, que es el sistema que uso para hacer backup de unRaid en la cuenta de GoogleDrive pero visto lo bien que habla todo el mundo de borg vamos a probarlo una temporada.\nSegundo, los equipos de oficina estaban configurados con Gnome y usando la herramienta Deja-dup hac√≠a los backups. El problema es que Deja-dup no funciona con KDE y me he visto obligado a emplear otra aplicaci√≥n. Kbackup es una buena opci√≥n, pero no acaba de convencerme. Vorta me parece que es una opci√≥n excelente as√≠ que vamos a ello.\nInstalaci√≥n de borgserver Buscamos en aplicaciones Unraid el servidor borg:\nRepository: nold360/borgserver:latest Network Type: Bridge SSH: 2222 # Ubicaci√≥n de las claves ssh sshkeys:/mnt/user/appdata/borg/sshkeys/ # Ubicaci√≥n de los backups backup: /mnt/user/Backups/borg Pulsamos en aplicar y no arranca el contenedor. El motivo es que si no hemos a√±adido alguna clave ssh antes no arrancar√°.\nEn la web del proyecto de hub.docker.com lo explica: !IMPORTANT!: The container wouldn\u0026rsquo;t start the SSH-Deamon until there is at least one ssh-keyfile in this directory!\nCopiamos nuestra clave p√∫blica a la siguiente ruta: /mnt/user/appdata/borg/sshkeys/clients En el momento de hacer este manual tengo dos claves p√∫blicas, la del pc port√°til y la del servidor sanmi:\n‚ûú clients pwd /mnt/user/appdata/borg/sshkeys/clients ‚ûú clients ls envy_kde.pub sanmi.pub Ahora si reiniciamos el contenedor deber√≠a arrancar sin problemas\nInstalaci√≥n de Vorta Backup en Fedora En mi caso he instalado Vorta a trav√©s de Discover en formato flatpak.\nIniciamos Vorta y comenzamos el procedimiento:\nPrimero creamos nuestra clave ssh:\nUna vez creada la clave ssh tenemos que copiarla a nuestro servidor borg a la siguiente ruta:\n/mnt/user/appdata/borg/sshkeys/clients A√±adimos nuestro repositorio de Borg:\nEs importante verificar correctamente los datos del repositorio. En mi caso:\nPESTA√ëA GENERAL: Repository URL: ssh://borg@DIRECCION_IP_TAILSCALE:2222/./envy Repository name: envy Enter passphrase: XXXXXXXXX PESTA√ëA ADVANCED: SSH Key: seleccionamos la clave ssh que hemos creado anteriormente Encryption: Repokey-Blake2 El resto de opciones las dejamos por defecto.\nPlanificamos la programaci√≥n tanto de backups como de prune:\nIMPORTANTE: En los Settings de Vorta debemos marcar \u0026ldquo;Automatically start Vorta at login\u0026rdquo; para que arranque al inicio.\nCon esto deber√≠a funcionar ya nuestro primer backup. Para restaurar es muy sencillo a trav√©s de Vorta. Procedemos a montar el backup que nos interese y realizamos la copia a nuestro sistema.\nConfiguraci√≥n del cliente borgmatic en los servidores (modo consola) Esta parte es un poco m√°s compleja porque se hace todo en modo consola, pero una vez configurada resulta todo muy sencillo.\nLa configuraci√≥n consiste en varios pasos (Nota: las claves empleadas en este manual son ficticias):\nInstalaci√≥n de borgmatic. Borgmatic nos permite realizar backups con borg a trav√©s de un sencillo fichero de configuraci√≥n. Instalaci√≥n de gpg y pass que nos har√°n falta para encriptar los backups en destino. Creamos nuestra contrase√±a gpg para almacenar el password de encriptado de la copia de seguridad. Creamos nueva clave ssh para logearse en nuestro servidor destino de los backups. Configuramos nuestro fichero config.yaml para borgmatic. Creamos nuestra pass para encriptar la copia de seguridad A√±adimos una entrada a crontab para programar los backups y las limpiezas. Instalaci√≥n de borgmatic sudo apt install borgmatic Instalaci√≥n de gpg y pass sudo apt install pass gpg Creaci√≥n clave gpg Configuramos nuestra clave gpg:\nsudo gpg --full-generate-key Tipo de clave: predeterminada Validez: sin caducidad Rellenamos nuestros datos personales y de correo: Nuestra contrase√±a para proteger la clave: Por √∫ltimo nos muestra un resumen de la clave creada: Si queremos ver nuevamente la clave ejecutamos el siguiente comando:\nsudo gpg --list-secret-keys --keyid-format LONG Nos genera la siguiente salida:\n[sudo] password for XXXXXXXXXXXXX: /root/.gnupg/pubring.kbx ------------------------ sec XXXXXXXXXX/XXXXXXXXXXXXXXXXXXXXXXXXX 2025-07-30 [SC] XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX uid [ultimate] xxxxxx XXXXXXXXXXXXXXX \u0026lt;XXXXXXXXXXXXXXX@XXXXXXXXXXXXXXX.com\u0026gt; ssb XXXXXXXXXX/XXXXXXXXXXXXXXXXXXXXXXXXX 2025-07-30 [E] Creaci√≥n de claves ssh sudo ssh-keygen -o -a 100 -t ed25519 Ponemos el nombre de fichero que vamos a usar para almacenar la clave y el resto lo dejamos sin contrase√±a. Una vez tenemos nuestra clave ssh la pasamos al servidor borgserver de Unraid (tenemos varias opciones con scp, ssh-cp-id, o creando el fichero a mano y a√±adiendo el contenido):\n# Servidor Unraid cd /mnt/user/appdata/borg/sshkeys/clients nano my_server.pub # y pegamos el contenido de la clave ssh.pub Posteriormente reiniciamos el servidor borg:\ndocker restart borgserver ### docker logs borgserver #### ######################################################## * Testing Volume BORG_DATA_DIR: /backup * Testing Volume SSH_KEY_DIR: /sshkeys * Checking / Preparing SSH Host-Keys... ######################################################## * Starting SSH-Key import... ** Adding client envy_kde.pub with repo path /backup/envy_kde.pub ** Adding client my_server.pub with repo path /backup/my_server.pub En la salida vemos que ya se ha a√±adido la nueva clave ssh a nuestro servidor borg.\nConfiguramos nuestro fichero config.yaml para borgmatic Generamos el fichero por defecto para borgmatic\nsudo generate-borgmatic-config # Hacemos una copia por seguridad sudo cp /etc/borgmatic/config.yaml /etc/borgmatic/config.yaml.bak # Editamos el fichero Editamos el fichero:\nsudo nano /etc/borgmatic/config.yaml Contenido definitivo del fichero de configuraci√≥n de borgmatic:\n# /etc/borgmatic/config.yaml location: source_directories: - /home/mi_usuario repositories: - ssh://borg@MY_SERVER_IP_TAILSCALE:2222/./mi_nombre_del_repositorio exclude_caches: true exclude_patterns: - \u0026#39;*.pyc\u0026#39; - /home/*/.cache storage: compression: auto,zstd encryption_passphrase: pass /super_admin@mi_compa√±√≠a.com/borg-repokey archive_name_format: \u0026#34;{hostname}-{now}\u0026#34; ssh_command: ssh -i /root/.ssh/my_server_ssh_key # Number of times to retry a failing backup # Needs recent Borgmatic version retries: 5 retry_wait: 5 retention: keep_daily: 3 keep_weekly: 4 keep_monthly: 12 consistency: checks: - disabled # Uncomment to regularly read all repo data # Needs recent Borgmatic version # - name: repository # frequency: 4 weeks # - name: archives # frequency: 8 weeks check_last: 3 Llegado a este punto ya est√° casi todo hecho, pero debemos prestar atenci√≥n a esta parte del fichero:\nencryption_passphrase: pass /super_admin@mi_compa√±√≠a.com/borg-repokey\nTenemos que generar nuestra pass para encritar la copia de seguridad. Vamos a ello.\nCreamos nuestra pass para encriptar la copia de seguridad sudo pass generate /super_admin@mi_compa√±√≠a.com/borg-repokey 16 Nos pedir√° la contrase√±a de nuestro gpg para encriptarla y nos la crea.\nPara ver lista de contrase√±as:\nsudo pass list Si queremos ver la contrase√±a:\nsudo pass list /super_admin@mi_compa√±√≠a.com/borg-repokey 16 Si queremos editar la contrase√±a:\nsudo pass edit /super_admin@mi_compa√±√≠a.com/borg-repokey 16 Y con esto ya est√° creada y lista para se usada en nuestro fichero config.yaml de borgmatic.\nVerificamos que nuestro fichero config.yaml no contenga errores:\nsudo validate-borgmatic-config -c /etc/borgmatic/config.yaml Primer backup El manejo de borgmatic en modo consola est√° muy bien explicado en la web docs.borgbase.com.\nsudo env \u0026#34;PATH=$PATH\u0026#34; validate-borgmatic-config sudo env \u0026#34;PATH=$PATH\u0026#34; borgmatic init --encryption repokey-blake2 sudo borgmatic create --list --stats Verificamos que lo ha creado:\nsudo borgmatic list ssh://borg@IP_My_server:2222/./my_repo: Listing archives my_server-2025-07-30T04:22:14 Wed, 2025-07-30 04:22:17 [f920bbec8c5f1ff80cfb794b801f1a3d55b3a90a52047f37bf8035e57902fb51] A√±adimos una entrada a crontab para programar los backups y las limpiezas. Vamos a programar nuestros backups y limpiezas a las 08.00 horas todos los d√≠as:\nsudo crontab -e # For more information see the manual pages of crontab(5) and cron(8) # # m h dom mon dow command 0 8 * * * /usr/bin/borgmatic --stats -v 0 2\u0026gt;\u0026amp;1 INFORMACI√ìN IMPORTANTE SOBRE EL COMANDO BORGMATIC\nEn el repositorio de github borgmatic-collective nos dice lo siguiente:\nIf you omit create and other actions, borgmatic runs through a set of default actions: prune any old backups as per the configured retention policy, compact segments to free up space (with Borg 1.2+, borgmatic 1.5.23+), create a backup, and check backups for consistency problems due to things like file damage. For instance:\nsudo borgmatic --verbosity 1 --list --stats En resumen, cuando no a√±adimos otras opciones a borgmatica, √©ste ejecuta de forma autom√°tica por defecto las siguientes operaciones: Prune, Compact, Backups y Check de backup, lo que me parece ideal para a√±adir el comando en cron.\nRestaurar el backup Esta la segunda parte m√°s importante. He realizado varias pruebas y todo ha funcionado correctamente. Para restaurar el backup primero hacemos un listado de los que tenemos y despu√©s montamos el backup en la ubicaci√≥n deseada para restaurar los ficheros:\nPrimero listamos los ficheros creados con borgmatic:\nsudo borgmatic list Una vez sabemos el fichero que nos interesa podemos ver el contenido:\nsudo borgmatic list --archive server-2020-04-01 Extracci√≥n completa de ficheros:\nsudo borgmatic extract --archive my_server-2025-07-30T04:24:04 --destination /mnt/new-directory Extracci√≥n de una parte solamente:\nsudo borgmatic extract --archive my_server-2020-04-01 --path mnt/catpics --destination /mnt/new-directory Notificaciones del Backup usando apprise Instalamos el software necesario. Seg√∫n su github Apprise permite enviar una notificaci√≥n a casi todos los servicios de notificaci√≥n m√°s populares disponibles en la actualidad, como: Telegram, Discord, Slack, Amazon SNS, Gotify, etc.\nInstalaci√≥n es sencilla:\nsudo apt install apprise Configuraci√≥n de nuestro fichero borgmatic conf:\nsudo nano /etc/borgmatic/config.yaml #### A√ëADIMOS ESTO AL FINAL de nuestro fichero de configuraci√≥n hooks: before_backup: - echo \u0026#34;Starting a backup job.\u0026#34; after_backup: - echo \u0026#34;Backup created.\u0026#34; - apprise -vv -t \u0026#34;‚úÖ SUCCESS Backup My_Server\u0026#34; -b \u0026#34;$(cat /tmp/backup_run.log)\u0026#34; \u0026#34;mailtos://smtp.gmail.com:587?user=super_admin@gmail.com\u0026amp;pass=superpasssecreta\u0026amp;from=superadmin@gmail.com\u0026amp;to=superadmin@hotmail.com,tgram://bot_token:de_telegram/chat_id_telegram/\u0026#34; on_error: - echo \u0026#34;Error while creating a backup.\u0026#34; - apprise -vv -t \u0026#34;‚ùå FAILED Backup My_Server\u0026#34; -b \u0026#34;$(cat /tmp/backup_run.log)\u0026#34; \u0026#34;mailtos://smtp.gmail.com:587?user=super_admin@gmail.com\u0026amp;pass=superpasssecreta\u0026amp;from=superadmin@gmail.com\u0026amp;to=superadmin@hotmail.com,tgram://bot_token:de_telegram/chat_id_telegram/\u0026#34; En mi caso he configurado para que nos env√≠e dos notificaciones. La primera por correo electr√≥nico y la segunda a Telegram.\nEn la versi√≥n de borgmatic 1.8.4+ Apprise se integra de forma nativa con borgmatic, lo que permite una configuraci√≥n mucho m√°s limpia, tal y como se muestra en la siguiente ejemplo. Esta configuraci√≥n yo no puedo usarla porque mi sistema tiene la versi√≥n borgmatic 1.7.7:\napprise: states: - start - finish - fail services: - url: mailtos://smtp.example.com:587?user=server@example.com\u0026amp;pass=YourSecurePassword\u0026amp;from=server@example.com\u0026amp;to=receiver@example.com label: mail - url: slack://token@Txxxx/Bxxxx/Cxxxx label: slack start: title: ‚öôÔ∏è Started body: Starting backup process. finish: title: ‚úÖ SUCCESS body: Backups successfully made. fail: title: ‚ùå FAILED body: Your backups have failed. En la versi√≥n 1.8.9+, los logs de borgmatic son a√±adidos automaticamenta al cuerpo de las notificaciones de apprise. Me parece una colaboraci√≥n impresionante. Que ganas tengo de que actualice Debian a la nueva versi√≥n de borgmatic.\nPor √∫ltimo, modificamos nuestro crontab para que al ejecutarse guarde la salida de las estad√≠sticas en el fichero /tmp/backup_run.log.\nsudo crontab -e # # # 30 8 * * * /usr/bin/borgmatic --stats -v 0 \u0026gt; /tmp/backup_run.log Con esto, nuestro borgmatica ya deber√≠a notificarnos:\nCorreo:\nTelegram:\nNotas finales a tener en cuenta En mi servidor sanmi tengo instalado Fedora Server. En este caso, la versi√≥n de borgmatic que nos acompa√±a es la versi√≥n 2.0.6 por lo que ya disponemos de las nuevas caracter√≠sticas para notificaciones y de un nuevo formato en el fichero config.yaml.\nRespecto a la configuraci√≥n de encryption_passcommand en borgmatic, se me presenta un problema.\nSi programamos el backup con cron, no se ejecuta. El motivo es que cada vez que se va a ejecutar, el comando pass nos solicita nuestra contrase√±a de la clave gpg y si no la introducimos el resto no contin√∫a. Entonces, para que los backups se realicen de forma autom√°tica sin intervenci√≥n del usuario, la √∫nica forma que he conseguido hacerlo es poniendo la contrase√±a directamente en el fichero config.yaml.\nConfiguraci√≥n de mi fichero config.yaml en Fedora Server:\nsource_directories: - /home/AppData - /home/super_admin repositories: - path: ssh://borg@100.100.100.100:2222/./sanMi label: sanMi exclude_caches: true exclude_patterns: - \u0026#39;*.pyc\u0026#39; - /home/*/.cache compression: auto,zstd encryption_passphrase: My_super_password #encryption_passcommand: pass /super_admin@gmail.com/borg-repokey archive_name_format: \u0026#34;{hostname}-{now}\u0026#34; ssh_command: ssh -i /root/.ssh/sanmi retries: 5 retry_wait: 5 keep_daily: 3 keep_weekly: 4 keep_monthly: 12 checks: - name: repository frequency: 4 weeks - name: archives frequency: 8 weeks check_last: 3 apprise: states: - start - finish - fail services: - url: mailtos://smtp.gmail.com:587?user=super_admin_@gmail.com\u0026amp;pass=super_password\u0026amp;from=super_admin@gmail.com\u0026amp;to=destino@hotmail.com label: mail - url: tgram://123456789:AAE39Q5XXXXXXXXXXXXXXX_XXXXXXXXXXXXXXXXXXXxPGrI/XXXXXXXXXXXX/ label: telegram start: title: ‚öôÔ∏è Starrted Backup body: Starting backup process finish: title: ‚úÖ SUCCESS Backup SanMi body: Backup SanMi success fail: title: ‚ùå FAILED Backup SanMi body: Backups SanMi failed Fuentes y enlaces de inter√©s que ayudaran a complementar esta gu√≠a:\nBorgserver en hub.docker.com Gu√≠a muy completa, base de casi todo el manual\nGu√≠a en espa√±ol con detalle de uso contrase√±a cifrado\nTutorial bilito para configurar borg en Unraid\nGu√≠a en espa√±ol configuraci√≥n pass y claves gpg para almacenar esas pass\nConfiguraci√≥n de pass como password-manager en consola\nDocumentaci√≥n Borgbase.com\nGithub de borgmatic-collective con ejemplos varios\nNotificaciones con apprise\nGithub de borgmatic-collective notificaciones apprise\nDoc notificaciones apprise Telegram\n","permalink":"https://blog.lasnotasdenoah.com/posts/borg-backups/","summary":"\u003ch2 id=\"configuraci√≥n-de-backups-con-borg\"\u003eConfiguraci√≥n de Backups con Borg\u003c/h2\u003e\n\u003cp\u003eNuestro servidor de Unraid va a servir para guardar los backups de nuestras m√°quinas. En concreto vamos a guardar los backups de los equipos (port√°tiles y m√≥viles) a trav√©s de Vorta, del VPS y del servidor Debian sanMi.\u003cbr\u003e\nEsta necesidad ha surgido por dos temas distintos:\u003cbr\u003e\nEl primero es la necesidad de hacer backup de nuestros servidores secundarios. Podr√≠a instalar Duplicacy, que es el sistema que uso para hacer backup de unRaid en la cuenta de GoogleDrive pero visto lo bien que habla todo el mundo de borg vamos a probarlo una temporada.\u003cbr\u003e\nSegundo, los equipos de oficina estaban configurados con Gnome y usando la herramienta Deja-dup hac√≠a los backups. El problema es que Deja-dup no funciona con KDE y me he visto obligado a emplear otra aplicaci√≥n. Kbackup es una buena opci√≥n, pero no acaba de convencerme. Vorta me parece que es una opci√≥n excelente as√≠ que vamos a ello.\u003c/p\u003e","title":"Borg Backups"},{"content":"Instalar Debian en particiones LVM encriptadas ya existentes conservando datos Arrancamos con el m√©dio de instalaci√≥n de Debian y seleccionamos Opciones avanzadas - Instalaci√≥n experta\nAvanzamos en el proceso de instalaci√≥n normalmente y en Load Installer components from CD cargamos los siguientes:\ncrypto-dm-modules and rescue-mode\nContinuamos con la instalaci√≥n y nos detenemos antes de Detect disks:\nAccedemos a una consola con ctrl+alt+f2 y realizamos la carga de nuestro LVM:\nCargamos los m√≥dulos necesarios (por motivo que desconozco este comando no funciona pero no es relevante para la instalaci√≥n)\ndepmod -a Listamos las particiones del sistema:\nblkid Desbloqueamos nuestro volumen LVM con cryptsetup:\ncryptsetup luksOpen /dev/vda3 debian-encriptado Enter passphrase for /dev/vda3: Abrimos nuestro VG volume group y verificamos que est√© disponible en dev/mapper/debian-encriptado:\nvgchange -ay ls /dev/mapper Presionamos ctrl+alt+f1 y continuamos con la instalaci√≥n normalmente:\nAhora ya tenemos disponibles nuestros vol√∫menes para instalar nuevamente el sistema:\nEn mi caso, formateo todas las particiones excepto el volumen /home que es donde estan mis datos de usuario y efi que est√° compartido con Windows:\nComo se ve tengo el siguiente particionado:\nvda1 - uefi - 100MB /boot/efi\nvda2 - boot - 1GB /boot\nvda3 - luks - 20GB\nVG debian - LV home - 5GB /home\nVG debian - LV root - 15GB\t/root\nContinuamos con la instalaci√≥n del sistema normal y nos detenemos antes de Install the GRUB bootloader to a hard disk.\nAccedemos nuevamente a la consola con ctrl+alt+f2 para configurar initramfs:\nNos interesa la partici√≥n TYPE=\u0026ldquo;crypto_LUKS\u0026rdquo;, que en mi caso es /dev/vda3:\nListamos las particiones del sistema:\nblkid cryptsetup luksDump /dev/vda3 |grep -F UUID Tenemos que modificar el fichero /target/etc/crypttab.\ncryptsetup luksDump /dev/vda3 |grep -F UUID \u0026gt;\u0026gt; /target/etc/crypttab Modificamos crypttab dejandolo as√≠:\n# \u0026lt;target name\u0026gt; \u0026lt;source device\u0026gt;\t\u0026lt;key file\u0026gt;\t\u0026lt;options\u0026gt; debian-encriptado UUID=3dfb977c-8368-4146-b7b9-5a2426aa4347 none luks,discard Volvemos a la instalaci√≥n con ctrl+alt+f1 y procedemos a instalar Grub bootloader.\nSi algo ha ido mal en la generaci√≥n de initramfs podemos iniciar nuevamente desde nuestro usb de debian y ejecutar un Rescue mode, seguimos los pasos de carga de nuestros vol√∫mnes LUKS, etc y a la hora de generamos initramfs manualmente con el siguiente comando:\nupdate-initramfs -u -k all Si hay alg√∫n error nos lo dir√° el comando y podemos corregir lo que sea neceario.\nInstalar Debian en particiones LVM NO encriptadas ya existentes conservando datos En este caso es todo muy sencillo. Seleccionamos particionado manual y el instalador de Debian nos detectar√° la estructura de particiones que tiene el disco y simplemente tenemos que indicar que volumenes queremos que se formateen y cuales no.\nDebemos dejar el sistema configurado como se muestra en la imangen y en ning√∫n momento es preciso salir del instalador a una consola. (NOTA: esta imagen est√° aprovechada del apartado donde se hac√≠a con encriptado, pero es exactamente lo mismo).\nFuentes:\nhttps://www.blakecarpenter.dev/installing-debian-on-existing-encrypted-lvm/\nhttps://consolematt.wordpress.com/2013/06/19/reinstalling-debian-on-existing-lukslvm-partition/\nhttps://www.reddit.com/r/debian/comments/1599rkt/how_to_reinstall_debian_12_with_existing/\n","permalink":"https://blog.lasnotasdenoah.com/posts/debian-luks-recovery/","summary":"\u003ch2 id=\"instalar-debian-en-particiones-lvm-encriptadas-ya-existentes-conservando-datos\"\u003eInstalar Debian en particiones LVM encriptadas ya existentes conservando datos\u003c/h2\u003e\n\u003cp\u003eArrancamos con el m√©dio de instalaci√≥n de Debian y seleccionamos Opciones avanzadas - Instalaci√≥n experta\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"debian.png\" loading=\"lazy\" src=\"/posts/debian-luks-recovery/debian.png\"\u003e\u003cbr\u003e\n\u003cimg alt=\"debian2.png\" loading=\"lazy\" src=\"/posts/debian-luks-recovery/debian2.png\"\u003e\u003c/p\u003e\n\u003cp\u003eAvanzamos en el proceso de instalaci√≥n normalmente y en Load Installer components from CD cargamos los siguientes:\u003cbr\u003e\n\u003cstrong\u003ecrypto-dm-modules and rescue-mode\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"debian3.png\" loading=\"lazy\" src=\"/posts/debian-luks-recovery/debian3.png\"\u003e\u003c/p\u003e\n\u003cp\u003eContinuamos con la instalaci√≥n y nos detenemos antes de Detect disks:\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"debian4.png\" loading=\"lazy\" src=\"/posts/debian-luks-recovery/debian4.png\"\u003e\u003c/p\u003e\n\u003cp\u003eAccedemos a una consola con \u003cstrong\u003ectrl+alt+f2\u003c/strong\u003e y realizamos la carga de nuestro LVM:\u003c/p\u003e","title":"Reinstalar Debian con LVM"},{"content":"Integrar Telegram en Home Assistant Resulta muy sencillo la integraci√≥n de Telegram. Modificamos el fichero configuration.yaml y a√±adimos lo siguiente:\nTenemos que crear nuestro bot a trav√©s de @BotFather. Una vez finalizado nos dar√° el api_key que necesitamos.\nPara obtener el id del chat usamos @GetIDs bot\ntelegram_bot: - platform: polling api_key: xxxxxxxxx:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx allowed_chat_ids: - 123456789 - 123456789-dos notify: - platform: telegram name: \u0026#34;telegram\u0026#34; chat_id: 123456789 - platform: telegram name: \u0026#34;telegram_dos\u0026#34; chat_id: 123456789-dos En name: \u0026ldquo;telegram\u0026rdquo; podemos poner el nombre que queramos, teniendo en cuenta que cuando llamemos a nuestro servicio debemos usar: notify.telegram, notify.my_home, etc\u0026hellip;\nComo vemos en el ejemplo, se puede hacer varias notificaciones distintas a distintos grupos o chats.\nReiniciamos Home Assistant y ya lo tenemos disponible. Nos vamos a Herramientas de desarrolladores -\u0026gt; Servicios para probarlo:\nMensaje sencillo:\nservice: notify.telegram data: message: \u0026#34;Yay! A message from Home Assistant.\u0026#34; Mensaje enviando una foto:\nservice: notify.telegram data: title: Send an images message: That\u0026#39;s an example that sends an image. data: photo: - file: /media/CCTV/2024/02/02/Tapia XXXXXX_00_20240202184131.jpg Fuentes y enlaces de inter√©s que ayudaran a complementar esta gu√≠a:\nhttps://www.home-assistant.io/integrations/telegram/\n","permalink":"https://blog.lasnotasdenoah.com/posts/home-assistant/","summary":"\u003ch3 id=\"integrar-telegram-en-home-assistant\"\u003eIntegrar Telegram en Home Assistant\u003c/h3\u003e\n\u003cp\u003eResulta muy sencillo la integraci√≥n de Telegram.\nModificamos el fichero configuration.yaml y a√±adimos lo siguiente:\u003c/p\u003e\n\u003cp\u003eTenemos que crear nuestro bot a trav√©s de \u003ca href=\"https://t.me/BotFather\"\u003e@BotFather\u003c/a\u003e. Una vez finalizado nos dar√° el api_key que necesitamos.\u003c/p\u003e\n\u003cp\u003ePara obtener el id del chat usamos \u003ca href=\"https://t.me/getidsbot\"\u003e@GetIDs bot\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003etelegram_bot\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#f92672\"\u003eplatform\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003epolling\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eapi_key\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003exxxxxxxxx:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eallowed_chat_ids\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e123456789\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e123456789\u003c/span\u003e-\u003cspan style=\"color:#ae81ff\"\u003edos\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003enotify\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#f92672\"\u003eplatform\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003etelegram\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;telegram\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003echat_id\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e123456789\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#f92672\"\u003eplatform\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003etelegram\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;telegram_dos\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003echat_id\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e123456789\u003c/span\u003e-\u003cspan style=\"color:#ae81ff\"\u003edos\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eEn name: \u0026ldquo;telegram\u0026rdquo; podemos poner el nombre que queramos, teniendo en cuenta que cuando llamemos a nuestro servicio debemos usar: notify.telegram, notify.my_home, etc\u0026hellip;\u003c/p\u003e","title":"Home Assistant y Telegram"},{"content":"Script de backup con rsync Con este peque√±o script hacemos el backup del USB del trabajo a nuestro disco duro:\nOrigen: /ruta origen\nDestino: /ruta destino\nOJO - cuando tenemos espacios en los nombres hay que usar \u0026lsquo;' para que el script sepa que es un espacio\n#!/bin/bash \u0026lt;\u0026lt; \u0026#39;Comment\u0026#39; Opciones rsync: --delete: borrar los archivos que fueron borrados de la carpeta origen en la carpeta destino -a: mantiene el usuario, grupo, permisos, fecha y hora, as√≠ como los enlaces simb√≥licos -v: la informaci√≥n imprimida durante la ejecuci√≥n del programa ser√° mucho m√°s detallada, -h: nos da las tasas de transferencia y el tama√±o de los archivos en unidades razonables -u: evitar copiar archivos que ya tenemos en la carpeta de destino que no has sido modificados en la carpeta de origen Comment rsync --progress --stats --delete -avhiu /media/user/Nuevo\\ vol/Origen /home/user/Destino Configuraci√≥n con reglas UDEV Primero debemos obtener el idProduct y el idVendor del nuestro usb\nlsusb Bus 002 Device 003: ID 0781:5581 SanDisk Corp. Ultra Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub idVendor = 0781\nidProduct = 5581\nCon estos datos creamos un fichero .rules:\nsudo nano /etc/udev/rules.d/10.backup_usb.rules SUBSYSTEM==\u0026#34;block\u0026#34;, ACTION==\u0026#34;add\u0026#34;, ATTRS{idVendor}==\u0026#34;0781\u0026#34;, ATTRS{idProduct}==\u0026#34;5581\u0026#34;, SYMLINK+=\u0026#34;external\u0026#34;, RUN+=\u0026#34;/home/user/backup_usb.sh\u0026#34; Por √∫ltimo, recargamos las reglas udev para que el sistema ejecute el script al enchufar nuestro pendrive:\nudevadm control --reload Este m√©todo funcionaria de maravilla para usb normales. El problema es que mi usb del trabajo est√° encritado con bitlocker y cuando se ejecuta la regla udev todav√≠a no est√° montada la partci√≥n del usb porque antes tenemos que introducir la contrase√±a de bitlocker, por lo que no funciona mi backup autom√°tico.\nConfiguraci√≥n con systemd La soluci√≥n al problema anterior es crear un servicio systemd que ejecute mi script de backup cuando se monta la partici√≥n que nos interesa.\nCreamos nuestro backup_usb.service en /home/user/.config/systemd/user:\ncat backup_usb.service [Unit] Description=Backup pendrive trabajo Requires=media-label-user.mount After=media-label-user.mount [Service] ExecStart=/home/user/Apps/backup_usb.sh [Install] WantedBy=media-label-user.mount Para buscar las media label:\nsudo systemctl list-units -t mount Aqui aparecer√° una etiqueta similar a esta entre otras muchas:\nmedia-user-Work.mount Por √∫ltimo habilitamos nuestro servicio:\nsystemctl --user enable backup_usb.service Al crear el enlace simb√≥lico nos dir√° el sistema que estamos creando un servicio con una dependencia que no existe:\nUnit /home/user/.config/systemd/user/backup_usb.service is added as a dependency to a non-existent unit media-user-Work.mount. No importa porque cuando se ejecute el servicio al insertar el pendrive deber√≠a funcionar correctamente ya que la unidad se crea en ese momento.\nFuentes:\nSystemd\nhttps://askubuntu.com/questions/25071/how-to-run-a-script-when-a-specific-flash-drive-is-mounted\n","permalink":"https://blog.lasnotasdenoah.com/posts/backup-usb/","summary":"\u003ch3 id=\"script-de-backup-con-rsync\"\u003eScript de backup con rsync\u003c/h3\u003e\n\u003cp\u003eCon este peque√±o script  hacemos el backup del USB del trabajo a nuestro disco duro:\u003cbr\u003e\nOrigen:  /ruta origen\u003cbr\u003e\nDestino: /ruta destino\u003cbr\u003e\nOJO - cuando tenemos espacios en los nombres hay que usar \u0026lsquo;' para que el script sepa que es un espacio\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026lt;\u0026lt; \u0026#39;Comment\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\tOpciones rsync: \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\t--delete: borrar los archivos que fueron borrados de la carpeta origen en la carpeta destino\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\t-a: mantiene el usuario, grupo, permisos, fecha y hora, as√≠ como los enlaces simb√≥licos\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\t-v: la informaci√≥n imprimida durante la ejecuci√≥n del programa ser√° mucho m√°s detallada,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\t-h: nos da las tasas de transferencia y el tama√±o de los archivos en unidades razonables\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\t-u: evitar copiar archivos que ya tenemos en la carpeta de destino que no has sido modificados en la carpeta de origen\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eComment\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ersync --progress --stats --delete  -avhiu /media/user/Nuevo\u003cspan style=\"color:#ae81ff\"\u003e\\ \u003c/span\u003evol/Origen /home/user/Destino\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"configuraci√≥n-con-reglas-udev\"\u003eConfiguraci√≥n con reglas UDEV\u003c/h3\u003e\n\u003cp\u003ePrimero debemos obtener el idProduct y el idVendor del nuestro usb\u003c/p\u003e","title":"Backups a USB autom√°tico"},{"content":"GSconnect Instalaci√≥n y configuraci√≥n de GSconnect\nGSConnect es una implementaci√≥n completa de KDE Connect especialmente para GNOME Shell con integraci√≥n de Nautilus, Chrome y Firefox. No depende de la aplicaci√≥n de escritorio KDE Connect y no funcionar√° si est√° instalada.\nKDE Connect permite que los dispositivos compartan contenido de forma segura, como notificaciones o archivos, y otras funciones como mensajer√≠a SMS y control remoto. El equipo de KDE Connect cuenta con aplicaciones para Linux, BSD, Android, Sailfish, iOS, macOS y Windows.\nEsp preciso seguir estos pasos en Debian para que nos conecte correctamente, ya que por experiencia propia de otra forma no funciona en algunas ocasiones:\nSi ha estado instalado y nos ha dado problemas, eliminar todo rastro de la aplicaci√≥n en el ordenador y en el m√≥vil.\nsudo apt autoremove --purge gnome-shell-extension-gsconnect Revisamos las carpetas ~/.config y ~/.cache y borramos cualquier resto de gsconnect.\nInstalar el paquete .deb con apt\nsudo apt install gnome-shell-extension-gsconnect Instalamos la extensi√≥n desde el gestor de extensiones de gnome:\nVerificar que ha sido todo correcto.\nReiniciar el ordenador.\nInstalar en el m√≥vil kde connect\nEn el m√≥vil refrescar para ver dispositivos y deber√≠a aparecer el ordenador para enlazar.\nAceptar y dar permisos en el m√≥vil a la aplicaci√≥n.\nPor √∫ltimo, tenemos que dar permisos en firewalld al servicio de GSconnect, no olvidando crear la regla de forma permanente.\nfirewall-cmd --permanent --zone=public --add-service=gsconnect Fuentes:\nhttps://userbase.kde.org/KDEConnect#Troubleshooting\n","permalink":"https://blog.lasnotasdenoah.com/posts/gsconnect/","summary":"\u003ch2 id=\"gsconnect\"\u003eGSconnect\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eInstalaci√≥n y configuraci√≥n de GSconnect\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eGSConnect es una implementaci√≥n completa de KDE Connect especialmente para GNOME Shell con integraci√≥n de Nautilus, Chrome y Firefox.  No depende de la aplicaci√≥n de escritorio KDE Connect y no funcionar√° si est√° instalada.\u003c/p\u003e\n\u003cp\u003eKDE Connect permite que los dispositivos compartan contenido de forma segura, como notificaciones o archivos, y otras funciones como mensajer√≠a SMS y control remoto.  El equipo de KDE Connect cuenta con aplicaciones para Linux, BSD, Android, Sailfish, iOS, macOS y Windows.\u003c/p\u003e","title":"Gsconnect (kdeconnect para Gnome)"},{"content":"Notas sobre configuraciones para uso de Python Instalaci√≥n de Pip\nPip es un sistema de gesti√≥n de paquetes utilizado para instalar y administrar paquetes de software escritos en Python.\nAdem√°s de instalar pip aprovechamos para instalar software de desarrollo de python muy util.\nsudo apt install python3-pip python-dev build-essential python3-venv El m√≥dulo venv proporciona soporte para crear ¬´entornos virtuales¬ª ligeros con sus propios directorios de ubicaci√≥n, aislados opcionalmente de los directorios de ubicaci√≥n del sistema.\nCada entorno virtual tiene su propio binario Python (que coincide con la versi√≥n del binario que se utiliz√≥ para crear este entorno) y puede tener su propio conjunto independiente de paquetes Python instalados en sus directorios de ubicaci√≥n.\nEn resumen, los entornos virtuales nos permiten tener un entorno de desarrollo en cada proyecto sin llenar el sistema de dependencias y paquetes instalados.\nPara crear un entorno virtual dentro del proyecto que estemos:\npython3 -m venv entorno_virtual De esta forma creamos una carpeta llamada entorno_virtual dentro del proyecto donde se almacenaran todos los archivos de python para ese entorno.\nAl abrir un proyecto con un entorno virtual, VSCode nos lo detecta autom√°ticamente lo activa directamente.\nSi no se activa directamente, o vamos a trabajar fuera de VSCode lo activamos nosotros:\nsource ruta/al/entorno/virtual/bin/activate Para desactivarlo:\ndeactivate Si queremos eliminar un entorno virtual:\nrm -rf ruta/al/entorno/virtual Nota SUPERIMPORTANTE\nSi vamos a usar el entorno virtual dentro de un proyecto en github tenemos que excluir esa carpeta de git. Para ello creamos un fichero .gitignore dentro de la carpeta entorno_virtual y excluimos todo con \u0026lsquo;*\u0026rsquo;:\nnano .gitignore * Una vez tengamos pip instalado podemos instalar los paquetes que necesitemos para nuestros proyectos:\npip install jupyter pandas request numpy etc..... Para actulizar pip:\npip install --upgrade pip Fuentes:\n[]https://code.tutsplus.com/es/tutorials/understanding-virtual-environments-in-python\u0026ndash;cms-28272](https://code.tutsplus.com/es/tutorials/understanding-virtual-environments-in-python--cms-28272)\nhttps://gee.es/2023/05/17/como-creo-un-entorno-de-desarrollo-con-env-en-vscode/\n","permalink":"https://blog.lasnotasdenoah.com/posts/python/","summary":"\u003ch2 id=\"notas-sobre-configuraciones-para-uso-de-python\"\u003eNotas sobre configuraciones para uso de Python\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eInstalaci√≥n de Pip\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003ePip es un sistema de gesti√≥n de paquetes utilizado para instalar y administrar paquetes de software escritos en Python.\u003cbr\u003e\nAdem√°s de instalar pip aprovechamos para instalar software de desarrollo de python muy util.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo apt install python3-pip python-dev build-essential python3-venv\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eEl m√≥dulo venv proporciona soporte para crear ¬´entornos virtuales¬ª ligeros con sus propios directorios de ubicaci√≥n, aislados opcionalmente de los directorios de ubicaci√≥n del sistema.\u003cbr\u003e\nCada entorno virtual tiene su propio binario Python (que coincide con la versi√≥n del binario que se utiliz√≥ para crear este entorno) y puede tener su propio conjunto independiente de paquetes Python instalados en sus directorios de ubicaci√≥n.\u003cbr\u003e\nEn resumen, los entornos virtuales nos permiten tener un entorno de desarrollo en cada proyecto sin llenar el sistema de dependencias y paquetes instalados.\u003cbr\u003e\nPara crear un entorno virtual dentro del proyecto que estemos:\u003c/p\u003e","title":"Python"},{"content":"Uso de FirewallD NOTA: En Joplin tengo un manual m√°s completo\nManual de ayuda:\nfirewall-cmd --help FirewallD funciona con systemd, por lo que se emplean todos los comandos de systemd:\nsystemctl enable firewalld systemctl start firewalld systemctl restart firewalld systemctl status firewalld Zonas de firewall Zonas de Firewalld.\nDe modo predeterminado Firewalld tiene diferentes tipos de zonas. Cada una tiene un distinto nivel de seguridad.\ndrop Descripci√≥n: Para redes p√∫blicas. Se descartan los paquetes de red entrantes no solicitados. Los paquetes entrantes que est√°n relacionados con las conexiones de red salientes son aceptados. Se permite el tr√°fico de salida. √âsta ser√≠a la zona m√°s segura. Ideal para paranoicos. Servicios habilitados: ninguno. Pol√≠tica predeterminada: DROP.\nblock Descripci√≥n: Para redes p√∫blicas. Se rechazan los paquetes de red entrantes no solicitados. Los paquetes entrantes que est√°n relacionados con las conexiones de red salientes son aceptados. Se permite el tr√°fico de salida. Servicios habilitados: ninguno. Pol√≠tica predeterminada: REJECT.\npublic Descripci√≥n: Es la zona predeterminada. Para redes p√∫blicas. S√≥lo se aceptan algunas conexiones entrantes selectas y el resto son rechazadas. Es ideal para √°reas p√∫blicas. Servicios habilitados: ssh y dhcpv6-client. Pol√≠tica predeterminada: REJECT.\nexternal Descripci√≥n: Para redes externas.S√≥lo se aceptan algunas conexiones entrantes selectas y el resto son rechazadas. Es ideal para redes externas con enmascaramiento habilitado especialmente para ruteadores. Servicios habilitados: ssh. Pol√≠tica predeterminada: REJECT.\ndmz Descripci√≥n: Para en sistemas zona desmilitarizada con acceso limitado a la red interna. S√≥lo se aceptan algunas conexiones entrantes selectas y el resto son rechazadas. Servicios habilitados: ssh. Pol√≠tica predeterminada: REJECT.\nwork Descripci√≥n: Para trabajo u oficina. Se conf√≠a en los sistemas que coexisten en la misma red pero s√≥lo se aceptan algunas conexiones entrantes selectas y el resto son rechazadas. Servicios habilitados: ssh, ipp-client y dhcpv6-client. Pol√≠tica predeterminada: REJECT.\nhome Descripci√≥n: Para el hogar. Se conf√≠a en los sistemas que coexisten en la misma red pero s√≥lo se aceptan algunas conexiones entrantes selectas y el resto son rechazadas. B√°sicamente igual que work. Servicios habilitados: ssh, ipp-client, mdns, samba-client y dhcpv6-client. Pol√≠tica predeterminada: REJECT.\ninternal Descripci√≥n: Para redes internas. Se conf√≠a en los sistemas que coexisten en la misma red pero s√≥lo se aceptan algunas conexiones entrantes selectas y el resto son rechazadas. Servicios habilitados: ssh, ipp-client, mdns, samba-client y dhcpv6-client. Pol√≠tica predeterminada: REJECT.\ntrusted Descripci√≥n: Todas las conexiones son aceptadas. Servicios habilitados: todos. Pol√≠tica predeterminada: ACCEPT.\nPrimeros comandos\nSi solo queremos recargar la configuraci√≥n:\nfirewall-cmd --reload El firewall dispone de diferentes zonas, cada una con sus particularidades, para verlas:\nfirewall-cmd --get-zones Para ver la que tenemos por defecto:\nfirewall-cmd --get-default-zone Servicios habilitados en la zona activa:\nfirewall-cmd --list-services Cambios temporales y permanentes\nLos cambios realizados con firewall-cmd sin la opci√≥n \u0026ndash;permanent se aplicar√°n de inmediato sin guardarse en la configuraci√≥n.\nLos cambios realizados con firewall-cmd con la opci√≥n \u0026ndash;permanent se guardan de inmediato en la configuraci√≥n pero s√≥lo aplicar√°n despu√©s de ejecutar firewall-cmd con la opci√≥n \u0026ndash;reload o systemctl restart firewalld.\nCambios de zona por defecto\nfirewall-cmd --set-default-zone=public A√±adir un servicio a una zona:\nfirewall-cmd --permanent --zone=public --add-service=gsconnect Si nos surge un problema tipo ransomware o similar que est√© sincronizando nuestros ficheros con el NAS o la nube podemos tomar medidas extremas:\nActivar el m√≥do p√°nico:\nfirewall-cmd --panic-on Desactivar:\nfirewall-cmd --panic-off Verificar estado:\nfirewall-cmd --query-panic Y un largo etc. de opciones\u0026hellip;.\nFuentes:\nhttps://blog.alcancelibre.org/staticpages/index.php/como-firewalld\nhttps://www.redhat.com/sysadmin/how-to-configure-firewalld\n","permalink":"https://blog.lasnotasdenoah.com/posts/firewalld-config/","summary":"\u003ch2 id=\"uso-de-firewalld\"\u003eUso de FirewallD\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eNOTA: En Joplin tengo un manual m√°s completo\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eManual de ayuda:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efirewall-cmd --help\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eFirewallD funciona con systemd, por lo que se emplean todos los comandos de systemd:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esystemctl enable firewalld\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esystemctl start firewalld\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esystemctl restart firewalld\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esystemctl status firewalld\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cem\u003e\u003cstrong\u003eZonas de firewall\u003c/strong\u003e\u003c/em\u003e\nZonas de Firewalld.\u003c/p\u003e\n\u003cp\u003eDe modo predeterminado Firewalld tiene diferentes tipos de zonas. Cada una tiene un distinto nivel de seguridad.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003edrop\u003c/strong\u003e\u003c/em\u003e\nDescripci√≥n: Para redes p√∫blicas. Se descartan los paquetes de red entrantes no solicitados. Los paquetes entrantes que est√°n relacionados con las conexiones de red salientes son aceptados. Se permite el tr√°fico de salida. √âsta ser√≠a la zona m√°s segura. Ideal para paranoicos.\nServicios habilitados: ninguno.\nPol√≠tica predeterminada: DROP.\u003c/p\u003e","title":"Firewalld configuraci√≥n"},{"content":" title: Configuraci√≥n NextDNS en router Asus con firmware Merlin y en equipos Debian con NetworkManager date: 2023-10-20 09:00:00 +0100 categories: [Network] tags: [config, network] # TAG names should always be lowercase img_path: /assets/pictures/ author: Instalaci√≥n de Nextdns firmware Merlin router ASUS En el github de Nextdns tenemos toda la informaci√≥n para la instalaci√≥n del NextDNS CLI Client en nuestro router. Este cliente emplea DNS-over-HTTPS.\nInstalaci√≥n\nNos conectamos por ssh al router y ejecutamos el script de instalaci√≥n:\nsh -c \u0026#39;sh -c \u0026#34;$(curl -sL https://nextdns.io/install)\u0026#34;\u0026#39; Tenemos otra opci√≥n para realizar la configuraci√≥n de NextDNS en nuestro router, esta vez empleando DNS-over-TLS:\nEN el reddit de nextdns se explica perfectamente.\nSi queremos saber la diferencia entre DNS-over-HTTPS y DNS-over-TLS en el siguiente enlace se explica muy bien.\nInstalaci√≥n de Nextdns en Debian Seg√∫n la web de NextDNS se recomienda la siguiente instalaci√≥n:\nEditar el fichero /etc/systemd/resolved.conf:\n[Resolve] DNS=45.90.28.0#user_id.dns.nextdns.io DNS=2a07:a8c0::#user_id.dns.nextdns.io DNS=45.90.30.0#user_id.dns.nextdns.io DNS=2a07:a8c1::#user_id.dns.nextdns.io DNSOverTLS=yes En Debian no ven√≠a preinstalado el servicio systemd-resolved y tuve que instalarlo. Pero surgi√≥ un problema: NextDNS no se lleva bien con NetworkManager cuando activamos alguna de las VPN de pago que tengo configuradas a trav√©s del protocolo OpenVPN. En esta entrada del blog NextDNS explican el mismo problema que yo tengo y con la soluci√≥n que aportan a mi no me ha funcionado.\nEn mi caso he optado por instalar NextDNS a trav√©s del cliente en l√≠nea de comando y cuando activo la VPN tengo que tener la precauci√≥n de parar NextDNS.\nRevisamos que est√© correctamente configurado el fichero /etc/resolv.conf:\nDeber√≠a tener l√≠neas similares a esta:\nnameserver 9.9.9.9 nameserver 8.8.8.8 nameserver 1.1.1.1 nameserver 192.168.1.1 Es importante revisar esto si hemos tenido instalado systemd-resolved o si viene instalado por defecto. En ese caso es importante desinstalarlo si vamos a trabajar con VPN hasta que se resuelva el bug.\nGu√≠a de desintalaci√≥n de systemd-resolved.\nInstalaci√≥n de cliente NextDNS\nsh -c \u0026#39;sh -c \u0026#34;$(curl -sL https://nextdns.io/install)\u0026#34;\u0026#39; Seguimos las instrucciones y ya deber√≠a funcionar.\nComandos b√°sicos:\nnextdns start nextdns stop nextdns restart nextdns status nextdns log nextdns help Desinstalar\nEjecutamos el mismo comando y elegimos la opci√≥n Uninstall en el men√∫.\nsh -c \u0026#39;sh -c \u0026#34;$(curl -sL https://nextdns.io/install)\u0026#34;\u0026#39; Uso de la VPN a trav√©s de NetworkManager\nMi operativa ahora es sencilla, NextDNS se inicia al arrancar el sistema.\nSi tengo que hacer uso de la VPN los pasos son los siguientes:\nsudo nextdns stop 2.- Activo la VPN a trav√©s del NetworkManager de Gnome\n3.- Hago el trabajo que sea.\n4.- Activo la VPN a trav√©s del NetworkManager de Gnome\nsudo nextdns start Fuentes:\nAsus\nhttps://github.com/nextdns/nextdns/wiki/AsusWRT-Merlin\nhttps://www.reddit.com/r/nextdns/comments/x2k8f3/asus_merlin_noncli_configuration_guide/\nhttps://www.cloudflare.com/es-es/learning/dns/dns-over-tls/.\nDebian\nhttps://help.nextdns.io/t/h7yhxk1/setting-up-nextdns-on-ubuntu-in-resolved-conf-doesnt-work-with-vpns-dns\nhttps://github.com/nextdns/nextdns/wiki\nhttps://gist.github.com/zoilomora/f7d264cefbb589f3f1b1fc2cea2c844c\n","permalink":"https://blog.lasnotasdenoah.com/posts/nextdns/","summary":"\u003chr\u003e\n\u003ch2 id=\"author\"\u003etitle: Configuraci√≥n NextDNS en router Asus con firmware Merlin y en equipos Debian con NetworkManager\ndate: 2023-10-20 09:00:00 +0100\ncategories: [Network]\ntags: [config, network]     # TAG names should always be lowercase\nimg_path: /assets/pictures/\nauthor: \u003c!-- raw HTML omitted --\u003e\u003c/h2\u003e\n\u003ch2 id=\"instalaci√≥n-de-nextdns-firmware-merlin-router-asus\"\u003eInstalaci√≥n de Nextdns firmware Merlin router ASUS\u003c/h2\u003e\n\u003cp\u003eEn el \u003ca href=\"https://github.com/nextdns/nextdns\"\u003egithub de Nextdns\u003c/a\u003e tenemos toda la informaci√≥n para la instalaci√≥n del NextDNS CLI Client en nuestro router. Este cliente emplea DNS-over-HTTPS.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eInstalaci√≥n\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eNos conectamos por ssh al router y ejecutamos el script de instalaci√≥n:\u003c/p\u003e","title":"Nextdns"},{"content":"Habilitar el safetynet en el m√≥vil con ROM personalizada ROM personalizada LINEAGEOS\nCuando nuestro tel√©fono ha llegado al fin de su vida √∫til en lo que se refiere a actualizaciones de seguridad, he decidido emplear una ROM personalizada que nos permite tener nuestro sistema actualizado y operativo. Entre las que he probado est√°n Pixel Experience y LineageOS entre otras.\nAl final me he decido por LineageOS ya que me da mucha confianza.\nAl usar estas ROM se genera un problema secundario, mi aplicaci√≥n de pagos a trav√©s de NFC dice que el sistema tiene una ROM personalizada y por seguridad no permite realizar el pago.\nTenemos varias soluciones:\n1.- Instalar MAGISK con un m√≥dulo de safetynet. Tal vez, si probara hoy me funcione, pero la segunda opci√≥n han sido 5 minutos y me ha funcionado a la primera.\n2.- Modificar el fichero /system/build.prop del tel√©fono m√≥vil.\nHe optado por esta segunda opci√≥n porque en su d√≠a lo intent√© con MAGISK y no lo hice funcionar, desconociendo el por qu√©.\nLa esencia consiste en modificar las siguientes l√≠neas del fichero /system/build.prop y cambiar el valor:\nro.secure=0 sustituirlos por ro.secure=1 ro.debuggable=1 sustituirlos por ro.debuggable=0 Para hacer este cambio tenemos que acceder al m√≥vil por adb, que debe estar correctamente instalado en nuestro ordenador.\nHabilitamos las opciones de desarrollador en el m√≥vil:\nAccedemos a Informaci√≥n del tel√©fono \u0026mdash;\u0026gt; N√∫mero de compilaci√≥n (pulsamos 5 veces)\nDespu√©s:\nSistema \u0026mdash;\u0026gt; Opciones de desarrollador\nActivamos Depuraci√≥n por USB y Depuraci√≥n como Superusuario.\nConectamos el tel√©fono al ordenador y activamos Transferencia de Archivos en lugar de Solo carga.\nAhora nos vamos a la terminal de nuestro ordenador y testeamos que detecta el tel√©fono:\n[noah@envy ~]$ ‚ï∞‚îÄ adb devices * daemon not running; starting now at tcp:5037 * daemon started successfully List of devices attached 967fd02\tdevice Vemos que detectamos el tel√©fono, procedemos con el cambio:\n[noah@envy ~]$ ‚ï∞‚îÄ adb root restarting adbd as root [noah@envy ~]$ ‚ï∞‚îÄ adb remount remount succeeded [noah@envy ~]$ ‚ï∞‚îÄ adb pull /system/build.prop . /system/build.prop: 1 file pulled, 0 skipped. 0.9 MB/s (7671 bytes in 0.008s) [noah@envy ~]$ ‚ï∞‚îÄ Ya tenemos el fichero build.prop y ahora vamos a modificar las dos l√≠neas que nos interesan. El comando sed nos permite sustituir una cadena de texto por otra:\nsed -i \u0026#34;s/ro.secure=0/ro.secure=1/\u0026#34; build.prop sed -i \u0026#34;s/ro.debuggable=1/ro.debuggable=0/\u0026#34; build.prop Volvemos a subir el fichero al tel√©fono m√≥vil:\nadb push build.prop /system/build.prop Y listo, reiniciamos el tel√©fono m√≥vil y ya podemos instalar nuestra aplicaci√≥n de pagos a trav√©s del NFC y deber√≠a funcionar.\nPara simplificar el trabajo podemos hacer un peque√±o script que lo haga todo a la primera:\n#!/bin/bash adb root adb remount adb pull /system/build.prop . sed -i \u0026#34;s/ro.secure=0/ro.secure=1/\u0026#34; build.prop sed -i \u0026#34;s/ro.debuggable=1/ro.debuggable=0/\u0026#34; build.prop adb push build.prop /system/build.prop rm build.prop LineageOS hace actualizaciones semanales de la ROM. Cada vez que actualicemos tenemos que ejecutar nuestro peque√±o script, activando las opciones de desarrollador, etc. por eso he decidido hacer actualizaciones mensuales mas o menos para no tener que estar pendiente de esto.\nFuentes:\nModificar fichero build.prop\nhttps://github.com/OmarAhmed-A/MakeLineageOSSecure\nhttps://forum.xda-developers.com/t/safetynet-on-lineageos-20-microg.4558065/\nMagisk\nhttps://topjohnwu.github.io/Magisk/install.html\nhttps://community.fxtec.com/topic/2537-magisk-install-step-by-step-root/\nhttps://telegra.ph/Instalar-Magisk-v24-en-nuestra-ROM\u0026ndash;Install-Magisk-on-our-ROM-03-11\n","permalink":"https://blog.lasnotasdenoah.com/posts/lineageos/","summary":"\u003ch2 id=\"habilitar-el-safetynet-en-el-m√≥vil-con-rom-personalizada\"\u003eHabilitar el safetynet en el m√≥vil con ROM personalizada\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eROM personalizada LINEAGEOS\u003c/strong\u003e\u003cbr\u003e\nCuando nuestro tel√©fono ha llegado al fin de su vida √∫til en lo que se refiere a actualizaciones de seguridad, he decidido emplear una ROM personalizada que nos permite tener nuestro sistema actualizado y operativo.\nEntre las que he probado est√°n \u003ca href=\"https://get.pixelexperience.org/\"\u003ePixel Experience\u003c/a\u003e y \u003ca href=\"https://lineageos.org/\"\u003eLineageOS\u003c/a\u003e entre otras.\u003c/p\u003e\n\u003cp\u003eAl final me he decido por LineageOS ya que me da mucha confianza.\u003c/p\u003e","title":"LineageOS y SafetyNet"},{"content":"Instalaci√≥n de Entware en firmware Merlin Fedora con Gnome trae instalado por defecto Gnome-Boxes. La verdad es que est√° genial pero tiene algunas carencias, como por ejemplo la conectividad de red.\nCon Gnome Boxes solo podemos acceder a nuestra m√°quina virtual desde el host pero no podemos acceder desde la red local o contactar con la red local desde la m√°quina virtual. Para eso vamos a instalar y configurar KVM Y Virt Manger.\nRequisitos\nVerificamos si tenemos la virtualizaci√≥n activa. Si no lo estuviera debemos acceder a la UEFI (BIOS) y activarla. grep -E --color \u0026#39;(vmx|svm)\u0026#39; /proc/cpuinfo Verificamos que el m√≥dulo KVM del kernel est√© cargado:\nlsmod | grep -i kvm Instalaci√≥n de los paquetes:\nsudo dnf install -y qemu-kvm libvirt virt-install bridge-utils Instalamos Virt-manager que es un gestor gr√°fico que facilita mucho el trabajo:\nsudo dnf install -y virt-manager M√≥dulos de virtualizaci√≥n adicionales:\nsudo dnf install -y libvirt-devel virt-top libguestfs-tools guestfs-tools Iniciamos y habilitamos el daemon de virtualizaci√≥n:\nsudo systemctl start libvirtd sudo systemctl enable libvirtd sudo systemctl status libvirtd Ahora crearemos una red puente a nuestro sistema para poder acceder a la red local:\nAccedemos a la configuraci√≥n de redes de QEMU/KVM:\nY configuramos el nombre. Forward to: Physical device\u0026hellip; Device: En mi caso he puesto la interfaz wifi: wlo1\nEl resto se configura seg√∫n gustos del usuario:\nSi tenemos m√°quinas virtuales creadas con Gnome Boxes podemos usarlas a trav√©s de Virt Manager y adaptar las conexiones de red a nuestras necesidades. Gnome Boxes guarda sus m√°quinas en: ~/.local/share/gnome-boxes/images\nPodemos importar el disco de almacenamiento de estas m√°quinas a Virt Manager Y configuramos la red eligiendo el bridge network que hemos creado:\ny ya deber√≠amos poder acceder con nuestra m√°quina virtual a los equipos de la red local o viceversa.\nFuentes:\nhttps://www.linuxtechi.com/how-to-install-kvm-on-fedora-step-by-step/\nhttps://computingforgeeks.com/how-to-create-and-configure-bridge-networking-for-kvm-in-linux/?expand_article=1\n","permalink":"https://blog.lasnotasdenoah.com/posts/kvm-virtmanager/","summary":"\u003ch2 id=\"instalaci√≥n-de-entware-en-firmware-merlin\"\u003eInstalaci√≥n de Entware en firmware Merlin\u003c/h2\u003e\n\u003cp\u003eFedora con Gnome trae instalado por defecto Gnome-Boxes. La verdad es que est√° genial pero tiene algunas carencias, como por ejemplo la conectividad de red.\u003cbr\u003e\nCon Gnome Boxes solo podemos acceder a nuestra m√°quina virtual desde el host pero no podemos acceder desde la red local o contactar con la red local desde la m√°quina virtual. Para eso vamos a instalar y configurar KVM Y Virt Manger.\u003c/p\u003e","title":"KVM y VirtManager"},{"content":" title: Instalaci√≥n de IDE IntelliJ date: 2023-06-16 22:00:00 +0100 categories: [Programming] tags: [software, programming] # TAG names should always be lowercase img_path: /pictures/ author: Instalaci√≥n del IDE de programaci√≥n IntelliJ Instalaci√≥n mediante Flatpak\nEs una buena opci√≥n a trav√©s del centro de software de Gnome pero a mi me dio problemas de bloqueos por lo que he decidido realizar la instalaci√≥n desde la web de jetbrains.\nDescargamos la versi√≥n Comunity de la web\nhttps://www.jetbrains.com/idea/download/#section=linux\nDescomprimimos el paquete en /opt:\nsudo tar -xzf ideaIU-*.tar.gz -C /opt Accedemos al directorio descomprimido:\ncd /opt/idea-IC-231.9011.34/bin ejecutamos ./idea.sh Por √∫ltimo podemos crear un enlace simbolico al path del sistema:\nsudo ln -s /opt/idea-IC-231.9011.34/bin/idea.sh /usr/bin/ideaC Para crear un enlace en el escritorio tenemos dos opciones:\nPrimera opci√≥n y m√°s complicada\nCopiamos el icono al directorio de iconos:\nsudo cp IntelliJ.svg /usr/share/icons/ y generamos el fichero IntelliJ.desktop en /usr/share/applications con el siguiente contenido:\n[Desktop Entry] Version=1.0 Type=Application Name=IntelliJ Comunity GenericName=IntelliJ Comment=Launch IntelliJ Icon=IntelliJ Categories=Development; Exec=ideaC TryExec=ideaC Terminal=false Segunda opci√≥n y m√°s sencilla\nAbrimos la aplicaci√≥n idea.sh y en el men√∫ principal:\nTools | Create Desktop Entry Fuentes:\nhttps://www.jetbrains.com/help/idea/installation-guide.html#standalone\n","permalink":"https://blog.lasnotasdenoah.com/posts/intellij/","summary":"\u003chr\u003e\n\u003ch2 id=\"author\"\u003etitle: Instalaci√≥n de IDE IntelliJ\ndate: 2023-06-16 22:00:00 +0100\ncategories: [Programming]\ntags: [software, programming]     # TAG names should always be lowercase\nimg_path: /pictures/\nauthor: \u003c!-- raw HTML omitted --\u003e\u003c/h2\u003e\n\u003ch2 id=\"instalaci√≥n-del-ide-de-programaci√≥n-intellij\"\u003eInstalaci√≥n del IDE de programaci√≥n IntelliJ\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eInstalaci√≥n mediante Flatpak\u003c/strong\u003e\u003cbr\u003e\nEs una buena opci√≥n a trav√©s del centro de software de Gnome pero a mi me dio problemas de bloqueos por lo que he decidido realizar la instalaci√≥n desde la web de jetbrains.\u003c/p\u003e","title":"IntelliJ IDE"},{"content":"Crear un servicio con systemd Crear un script Antes que nada necesitamos crear un script que no es m√°s que un simple archivo, que debe contener algo muy importante para arrancar y es #!/bin/bash, as√≠ que usamos un editor, en mi caso nano para crearlo:\nnano /usr/local/sbin/servicios Dentro vamos a colocar lo que necesitamos quedando con la siguiente estructura:\n#!/bin/bash contenido del script Una vez que lo guardamos con F2, le damos permisos de ejecuci√≥n.\nchmod +x /usr/local/sbin/servicios Crear el servicio con systemd Es importante que el nombre al final termine con .service, dado que as√≠ lo entender√° systemd. Record√° que tambi√©n debe tener permisos (otra forma es # chmod 777 servicio.service)\nnano /etc/systemd/system/servicios.service El contenido ser√° el siguiente, teniendo en cuenta que la primera de las instrucciones especifica que se debe iniciar tras secci√≥n syslog.target.\nExecStart=/usr/local/sbin/servicio.service se da la ruta en d√≥nde realmente est√° el script a ejecutar.\nDespu√©s viene el tipo de servicio que hay varios, pero para este caso ser√°:\n[Service] Type=forking\nPor √∫ltimo, la secci√≥n [Install] nos dice en qu√© runlevel se ejecutar√°. En el modo multiusuario o en el cl√°sico sysv, que ser√≠a el runlevel 3.\nEl contenido entonces deber√° ser algo como:\n[Unit] Description=Lanza servicios varios After=syslog.target [Service] Type=forking ExecStart=/usr/local/sbin/servicios [Install] WantedBy=multi-user.target Una vez este todo configurado debemos recargar.\nsudo systemctl daemon-reload Para lanzar el servicio simplemente hacemos:\nsudo systemctl start servicios.service Para habilitarlo al inicio y que se lance autom√°ticamente:\nsudo systemctl enable servicios.service Y finalmente para ver el estado podemos hacer:\nsudo systemctl status servicios.service ","permalink":"https://blog.lasnotasdenoah.com/posts/systemd/","summary":"\u003ch2 id=\"crear-un-servicio-con-systemd\"\u003eCrear un servicio con systemd\u003c/h2\u003e\n\u003ch3 id=\"crear-un-script\"\u003eCrear un script\u003c/h3\u003e\n\u003cp\u003eAntes que nada necesitamos crear un script que no es m√°s que un simple archivo, que debe contener algo muy importante para arrancar y es #!/bin/bash, as√≠ que usamos un editor, en mi caso nano para crearlo:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enano /usr/local/sbin/servicios\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eDentro vamos a colocar lo que necesitamos quedando con la siguiente estructura:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econtenido del script\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eUna vez que lo guardamos con F2, le damos permisos de ejecuci√≥n.\u003c/p\u003e","title":"Systemd"},{"content":"A√±adir accesos directos de Office Online a Gnome Hay que reconocer que Microsoft Office es muy superior a alternativas libres. En alguna ocasi√≥n podemos necesitar su uso. Para que resulte m√°s c√≥modo creamos estos accesos en el escritorio de Gnome:\nCopiar los ficheros de acceso en:\n~/.local/share/applications Copiar los iconos en:\n~/.local/share/icons Ficheros:\nIconos de Office\nFicheros .desktop\n","permalink":"https://blog.lasnotasdenoah.com/posts/office/","summary":"\u003ch2 id=\"a√±adir-accesos-directos-de-office-online-a-gnome\"\u003eA√±adir accesos directos de Office Online a Gnome\u003c/h2\u003e\n\u003cp\u003eHay que reconocer que Microsoft Office es muy superior a alternativas libres. En alguna ocasi√≥n podemos necesitar su uso. Para que resulte m√°s c√≥modo creamos estos accesos en el escritorio de Gnome:\u003cbr\u003e\nCopiar los ficheros de acceso en:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~/.local/share/applications\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eCopiar los iconos en:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~/.local/share/icons\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eFicheros:\u003cbr\u003e\n\u003ca href=\"/assets/files/icons.zip\"\u003eIconos de Office\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"/assets/files/links.zip\"\u003eFicheros .desktop\u003c/a\u003e\u003c/p\u003e","title":"Microsoft Office Online"},{"content":"Problemas al ejecutar algunos programas con renderizado gpu Algunos programas generan errores de visualizaci√≥n debido al renderizado de GPU con drivers Nvidia. En la mayor√≠a lo podemos deshabilitar:\nVISUAL STUDIO CODE\nPrimera opci√≥n\nDentro de Visual Studio abrimos la paleta (Ctrl+Shift+P). Ejecutamos: Preferences: Configure Runtime Arguments Este comando abre el fichero de configuraci√≥n \u0026ldquo;argv.json\u0026rdquo; y a√±adimos el siguiente texto \u0026#34;disable-hardware-acceleration\u0026#34;: true y reiniciamos Visual Studio Code\nSegunda Opci√≥n\nModificar el fichero \u0026ldquo;argv.json\u0026rdquo; de Visual Studio desde la terminal: nano ~/.vscode/argv.json A√±adimos el mismo texto que dec√≠amos antes\n\u0026#34;disable-hardware-acceleration\u0026#34;: true Tercera Opci√≥n\nModificar el lanzador de la aplicaci√≥n de escritorio en Gnome: Editamos el fichero /usr/share/applications/code.desktop. Cambiamos\n`Exec=/usr/share/code/code --unity-launch %F` por `Exec=/usr/share/code/code --disable-gpu --unity-launch %F` TEAMS\nModificar el fichero\n~/.config/Microsoft/Microsoft Teams/desktop-config.json\nCambiamos\n\u0026#34;disableGpu\u0026#34;:false (por defecto la opci√≥n es FALSE) por \u0026#34;disableGpu\u0026#34;:true THUNDERBIRD\nEn la configuraci√≥n hay que deshabilitar la aceleraci√≥n por hardware:\nFuentes:\n","permalink":"https://blog.lasnotasdenoah.com/posts/gpu-render/","summary":"\u003ch2 id=\"problemas-al-ejecutar-algunos-programas-con-renderizado-gpu\"\u003eProblemas al ejecutar algunos programas con renderizado gpu\u003c/h2\u003e\n\u003cp\u003eAlgunos programas generan errores de visualizaci√≥n debido al renderizado de GPU con drivers Nvidia. En la mayor√≠a lo podemos deshabilitar:\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eVISUAL STUDIO CODE\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ePrimera opci√≥n\u003cbr\u003e\nDentro de Visual Studio abrimos la paleta (Ctrl+Shift+P).\nEjecutamos:\n\u003ccode\u003ePreferences: Configure Runtime Arguments\u003c/code\u003e\nEste comando abre el fichero de configuraci√≥n \u0026ldquo;argv.json\u0026rdquo; y a√±adimos el siguiente texto\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;disable-hardware-acceleration\u0026#34;\u003c/span\u003e: true \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ey reiniciamos Visual Studio Code\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSegunda Opci√≥n\u003cbr\u003e\nModificar el fichero \u0026ldquo;argv.json\u0026rdquo; de Visual Studio desde la terminal:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enano ~/.vscode/argv.json\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eA√±adimos el mismo texto que dec√≠amos antes\u003c/p\u003e","title":"Problemas con Nvidia"},{"content":"Qu√© es y c√≥mo funciona el comando Screen en Linux Hablamos del programa Screen, que permite en los sistemas GNU/Linux, abrir m√∫ltiples instancias de terminal dentro de una sola sesi√≥n. De esta manera, si salimos de una de las instancias de terminal, el proceso que se ejecute en dicha terminal no se interrumpir√° y continuar√° en segundo plano.\n¬øEn qu√© consiste el comando Screen? Screen, seg√∫n indica su p√°gina de man, es un administrador de ventanas en pantalla completa, que multiplexa un terminal en varios procesos, cada proceso asociado a una nueva terminal.\nCuando se utiliza el comando Screen, este crea una √∫nica ventana con una terminal en ella (o un comando especificado) de forma independiente. Por lo que, en cualquier momento, podemos crear nuevas ventanas con otros programas.\nPermite tambi√©n obtener una lista de las ventanas activas, activar o desactivar el registro de salida, copiar y pegar texto en las ventanas, mostrar el historial, cambiar entre ventanas, etc√©tera.\nPara usuarlo s√≥lo hemos de escribir ‚Äúscreen‚Äù\nscreen Existe la posibilidad de asignar un nombre a una nueva sesi√≥n, como se muestra en el ejemplo, utilizando el par√°metro ‚Äú-S‚Äù\nscreen -S nombre-de-sesi√≥n Si nos queremos desvincular de una sesi√≥n hemos de utilizar la siguiente combinaci√≥n de teclas:\nCtrl+a d Para volver a una sesi√≥n ya existente debemos utilizar el par√°metro ‚Äú-r‚Äù\nscreen -r Fuentes:\n","permalink":"https://blog.lasnotasdenoah.com/posts/screen-command/","summary":"\u003ch2 id=\"qu√©-es-y-c√≥mo-funciona-el-comando-screen-en-linux\"\u003eQu√© es y c√≥mo funciona el comando Screen en Linux\u003c/h2\u003e\n\u003cp\u003eHablamos del programa \u003cstrong\u003eScreen\u003c/strong\u003e, que permite en los sistemas \u003cstrong\u003eGNU\u003c/strong\u003e/\u003cstrong\u003eLinux\u003c/strong\u003e, abrir m√∫ltiples instancias de terminal dentro de una sola sesi√≥n. De esta manera, si salimos de una de las instancias de terminal, el proceso que se ejecute en dicha terminal no se interrumpir√° y continuar√° en segundo plano.\u003c/p\u003e\n\u003ch3 id=\"en-qu√©-consiste-el-comando-screen\"\u003e¬øEn qu√© consiste el comando Screen?\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eScreen\u003c/strong\u003e, seg√∫n indica su p√°gina de \u003ca href=\"https://linux.die.net/man/1/screen\"\u003e\u003cstrong\u003eman\u003c/strong\u003e\u003c/a\u003e, es un administrador de ventanas en pantalla completa, que multiplexa un terminal en varios procesos, cada proceso asociado a una nueva terminal.\u003c/p\u003e","title":"Comando \"screen\""},{"content":"Qu√© es y c√≥mo funciona el comando find en Linux La sint√°xis b√°sica del comando ‚Äúfind‚Äù es:\nfind directorio criterio acci√≥n\nDirectorio.- define la ubicaci√≥n desde la que se quiere empezar la b√∫squeda. Por ejemplo: /home/ Criterio.- se usa para seleccionar los archivos. Se pueden usar comodines. Por ejemplo: *.tmp Acci√≥n.- se especifica aqu√≠ qu√© debe hacer el comando con los archivos que cumplan con el criterio indicado. Para eliminar m√∫ltiples archivos del tipo que queramos:\nfind . -name \u0026#34;archivo\u0026#34; -exec rm -rf {} \\\\; o\nfind . -type f -name \u0026#34;archivo\u0026#34; -exec rm -rf {} \\\\; La diferencia entre ambos comandos indicados arriba es que el primero localiza y borra archivos y directorios, y el segundo s√≥lo archivos.\n-name ‚Äúarchivo‚Äù.- se indica aqu√≠ qu√© estamos buscando. Se pueden usar comodines. -exec rm -rf.- Ejecuta el comando indicado a continuaci√≥n, es decir, tras el ‚Äú-exec‚Äù insertamos el comando que se ejecutar√° con cada archivo encontrado. En este caso es ‚Äúrm‚Äù con el modificador ‚Äú-rf‚Äù, que significa borrar de forma recursiva sin preguntar. -type f: Permite filtrar para incluir s√≥lo f(icheros) o d(irectorios). Ejemplos: Mucho mucho ojo al usar estos comandos como root:\nBuscar y borrar todos los archivos con extensi√≥n *.bak en el directorio en el que est√°s:\nfind . -type f -name \u0026#34;*.bak\u0026#34; -exec rm -f {} \\\\; Buscar todos los nombres de archivo que contengan la palabra ‚Äúcore‚Äù desde la ra√≠z y eliminarlos:\nfind / -name core -exec rm -f {} \\\\; Buscar y eliminar los archivos *.bak desde el directorio actual pero pidiendo confirmaci√≥n por cada archivo encontrado:\nfind . -type f -name \u0026#34;*.bak\u0026#34; -exec rm -i {} \\\\; Buscar y eliminar archivos ocultos en el directorio que estamos:\nfind -type f -name \u0026#34;.*\u0026#34; -exec rm -f {} \\; Fuentes:\n","permalink":"https://blog.lasnotasdenoah.com/posts/find-command/","summary":"\u003ch2 id=\"qu√©-es-y-c√≥mo-funciona-el-comando-find-en-linux\"\u003eQu√© es y c√≥mo funciona el comando find en Linux\u003c/h2\u003e\n\u003cp\u003eLa sint√°xis b√°sica del comando ‚Äúfind‚Äù es:\u003c/p\u003e\n\u003cp\u003efind directorio criterio acci√≥n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eDirectorio\u003c/strong\u003e.- define la ubicaci√≥n desde la que se quiere empezar la b√∫squeda. Por ejemplo: /home/\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCriterio\u003c/strong\u003e.- se usa para seleccionar los archivos. Se pueden usar comodines. Por ejemplo: *.tmp\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAcci√≥n\u003c/strong\u003e.- se especifica aqu√≠ qu√© debe hacer el comando con los archivos que cumplan con el criterio indicado.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003ePara eliminar m√∫ltiples archivos del tipo que queramos:\u003c/p\u003e","title":"Comando \"find\""},{"content":"Instalaci√≥n de Entware en firmware Merlin Entware es un repositorio de software que nos va a permitir la instalaci√≥n de diferentes programas en nuestro router. Software disponible en Entware\nRequisitos\nEs necesario tener conectado un disco USB en el router formateado con ext2 o ext3 Si est√° instalado Download Manager, se debe desinstalar y reiniciar el router Instalaci√≥n\nDescargar el script y a√±adirlo al usb. Nos conectamos por ssh al router. Ejecutar el script:\nusuario@RT-AC86U-3EB8:/tmp/home/root# entware-setup.sh Info: This script will guide you through the Entware installation. Info: Script modifies \u0026#34;entware\u0026#34; folder only on the chosen drive, Info: no other data will be changed. Existing installation will be Info: replaced with this one. Also some start scripts will be installed, Info: the old ones will be saved on Entware partition with name Info: like /tmp/mnt/sda1/jffs_scripts_backup.tgz Entware se instalar√° en el USB. Si tenemos varios nos preguntar√° donde instalarlo.\nUso\nopkg list - lista todos los paquetes disponibles para instalar opkg install nombre_software - instala el paquete nombre_software opkg remove software_name - borra el paquete nombre_software A partir de aqu√≠ podemos instalar software como Tailscale.\nFuentes:\nhttps://elblogdelazaro.org/posts/2019-01-02-instalacion-de-entware-en-firmware-merlin/\nhttps://github.com/RMerl/asuswrt-merlin/wiki/Entware\n","permalink":"https://blog.lasnotasdenoah.com/posts/asus-merlin/","summary":"\u003ch2 id=\"instalaci√≥n-de-entware-en-firmware-merlin\"\u003eInstalaci√≥n de Entware en firmware Merlin\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/RMerl/asuswrt-merlin/wiki/Entware\"\u003eEntware\u003c/a\u003e es un repositorio de software que nos va a permitir la instalaci√≥n de diferentes programas en nuestro router. \u003ca href=\"http://bin.entware.net/armv7sf-k3.2/Packages.html\"\u003eSoftware disponible en Entware\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eRequisitos\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eEs necesario tener conectado un disco USB en el router formateado con ext2 o ext3\u003c/li\u003e\n\u003cli\u003eSi est√° instalado Download Manager, se debe desinstalar y reiniciar el router\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eInstalaci√≥n\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eDescargar el script y a√±adirlo al usb.\nNos conectamos por ssh al router.\nEjecutar el script:\u003c/p\u003e","title":"Entware"},{"content":"Configuraci√≥n sistema para ejecutar web est√°tica en local antes de subir a github Instalaci√≥n de rubygems\nInstalamos el software necesario a trav√©s de DNF:\nsudo dnf install ruby rubygems ruby-devel gcc gcc-c++ rpm-build Para Debian 12:\nsudo apt install ruby ruby-dev build-essential Le decimos al administrador de gemas donde queremos que se instalen las gemas: Editamos .zshrc y a√±adimos esto al final:\n# Install Ruby Gems to ~/gems export GEM_HOME=\u0026#34;$HOME/gems\u0026#34; export PATH=\u0026#34;$PATH:~/bin\u0026#34; export PATH=\u0026#34;$HOME/gems/bin:$PATH\u0026#34; Recargamos el entorno de Zsh:\nsource .zshrc Ahora ya podemos instalar las gemas. Instalamos las gemas de jekyll y bundler:\ngem install jekyll bundler Como estamos usando la plantilla de just-the-docs ya vienen preparada con un Gemfile que es el que indica las gemas necesarias para ejecutar en local con jekyll.\nEjecutamos dentro del directorio de nuestro proyecto:\nbundle install Despu√©s:\nbundle exec jekyll serve Se arrancar√° el servidor en:\nlocalhost:4000 Es posible que el sistema lance un error similar a este:\nzsh: jekyll: command not found... Install package \u0026#39;rubygem-jekyll\u0026#39; to provide command \u0026#39;jekyll\u0026#39;? [N/y] nnn Eso significa que no encuentra jekyll como comando. En mi sistema los ejecutables de las gemas se instalaban en el siguiente path: ~/bin\nHaciendo un ls aparecen los siguientes ejecutables:\nbundle jekyll kramdown rake safe_yaml bundler just-the-docs listen rougify En stacoverflow aportan una posible soluci√≥n. Todo se limita a a√±dir al PATH el directorio donde se encuentran los ejecutables:\nnano .zshrc copy and past these two lines of code at the end of the .zshrc export GEM_HOME=\u0026#34;$(ruby -e \u0026#39;puts Gem.user_dir\u0026#39;)\u0026#34; export PATH=\u0026#34;$PATH:$GEM_HOME/bin\u0026#34; En ~/.local/share/gem/ruby se copia la carpeta ~/bin o bien se a√±ade directamente esta √∫ltima al path.\nY si queremos eliminar todas las gemas instaladas de Ruby:\nfor i in \u0026#39;gem list --no-versions\u0026#39;; do gem uninstall -aIx $i; done Para eliminar s√≥lo una:\ngem uninstall gemaaaaaa --version 1.1.9 Fuentes:\nhttps://docs.github.com/es/pages/setting-up-a-github-pages-site-with-jekyll/creating-a-github-pages-site-with-jekyll\nhttps://docs.github.com/es/pages/setting-up-a-github-pages-site-with-jekyll/testing-your-github-pages-site-locally-with-jekyll\nhttps://github.com/just-the-docs/just-the-docs-template/blob/main/README.md\nhttp://brionescl.blogspot.com/2014/02/eliminar-todas-las-gemas-de-ruby.html\n","permalink":"https://blog.lasnotasdenoah.com/posts/jekyll/","summary":"\u003ch2 id=\"configuraci√≥n-sistema-para-ejecutar-web-est√°tica-en-local-antes-de-subir-a-github\"\u003eConfiguraci√≥n sistema para ejecutar web est√°tica en local antes de subir a github\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eInstalaci√≥n de rubygems\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eInstalamos el software necesario a trav√©s de DNF:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo dnf install ruby rubygems ruby-devel gcc gcc-c++ rpm-build\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ePara Debian 12:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo apt install ruby ruby-dev build-essential\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eLe decimos al administrador de gemas donde queremos que se instalen las gemas:\nEditamos .zshrc y a√±adimos esto al final:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Install Ruby Gems to ~/gems\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport GEM_HOME\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$HOME\u003cspan style=\"color:#e6db74\"\u003e/gems\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport PATH\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$PATH\u003cspan style=\"color:#e6db74\"\u003e:~/bin\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport PATH\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$HOME\u003cspan style=\"color:#e6db74\"\u003e/gems/bin:\u003c/span\u003e$PATH\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eRecargamos el entorno de Zsh:\u003c/p\u003e","title":"Web est√°tica con Jekyll"},{"content":"Instalaci√≥n de drivers NVIDIA en Fedora Verificamos si en el administrador de software de Gnome aparecen los drivers Nvidia:\nEn caso afirmativo podemos saltarnos el siguiente paso. Si no aparecen los drivers de Nvidia quiere decir que tenemos que actualizar el repositorio RPMFusion\nInstalaci√≥n de forma gr√°fica desde administrador de software\nInstalamos el software necesario a trav√©s de DNF: Instalamos primeramente el repositorio free:\nsudo dnf install https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm Y despu√©s instalamos el non-free que es donde se alojan los drivers de Nvidia:\nsudo dnf install https://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm sudo dnf upgrade -y Si hacemos la instalaci√≥n de forma gr√°fica instalamos ‚ÄúNvidia Linux Graphics Driver‚Äù y ‚ÄúNvidia X Server Settings‚Äù.\nLos dem√°s no. Como se ve en la captura anterior.\nInstalaci√≥n desde la terminal\nsudo dnf -y install kmod-nvidia sudo dnf install xorg-x11-drv-nvidia-cuda Puedes ejecutarlos juntos o uno y despu√©s el otro. El primero instala los drivers generales y el segundo comando el oporte para CUDA(cuda son los n√∫cleos de Nvidia, una gr√°fica tiene miles normalmente a d√≠a de hoy, ser√≠a el equivalente a los n√∫cleos de las CPU).\nDe hecho, puedes instalar solo los drivers y prescindir del segundo programa, pero es mejor ambos.\nProblemas al ejecutar algunos programas\nAlgunos programas dan problemas al ejecutarse con el renderizado de la GPU activada. Pasos para desactivarlo:\nVISUAL STUDIO CODE\nPrimera opci√≥n\nDentro de Visual Studio abrimos la paleta (Ctrl+Shift+P). Ejecutamos: Preferences: Configure Runtime Arguments Este comando abre el fichero de configuraci√≥n \u0026ldquo;argv.json\u0026rdquo; y a√±adimos el siguiente texto \u0026#34;disable-hardware-acceleration\u0026#34;: true y reiniciamos Visual Studio Code\nSegunda Opci√≥n\nModificar el fichero \u0026ldquo;argv.json\u0026rdquo; de Visual Studio desde la terminal: nano ~/.vscode/argv.json A√±adimos el mismo texto que dec√≠amos antes\n\u0026#34;disable-hardware-acceleration\u0026#34;: true Tercera Opci√≥n\nModificar el lanzador de la aplicaci√≥n de escritorio en Gnome: Editamos el fichero /usr/share/applications/code.desktop. Cambiamos\n`Exec=/usr/share/code/code --unity-launch %F` por `Exec=/usr/share/code/code --disable-gpu --unity-launch %F` TEAMS\nModificar el fichero\n~/.config/Microsoft/Microsoft Teams/desktop-config.json\nCambiamos\n\u0026#34;disableGpu\u0026#34;:false por \u0026#34;disableGpu\u0026#34;:false THUNDERBIRD\nEn la configuraci√≥n hay que deshabilitar la aceleraci√≥n por hardware:\nFuentes:\nhttps://yourgeekweb.com/es/2022/06/18/como-instalar-los-drivers-de-nvidia-en-linux-fedora/\n","permalink":"https://blog.lasnotasdenoah.com/posts/nvidia-fedora/","summary":"\u003ch2 id=\"instalaci√≥n-de-drivers-nvidia-en-fedora\"\u003eInstalaci√≥n de drivers NVIDIA en Fedora\u003c/h2\u003e\n\u003cp\u003eVerificamos si en el administrador de software de Gnome aparecen los drivers Nvidia:\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"Foto.png\" loading=\"lazy\" src=\"/posts/nvidia-fedora/gnome-software-driver-nvidia-1024x666.png\"\u003e\nEn caso afirmativo podemos saltarnos el siguiente paso.\nSi no aparecen los drivers de Nvidia quiere decir que tenemos que actualizar el repositorio RPMFusion\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eInstalaci√≥n de forma gr√°fica desde administrador de software\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eInstalamos el software necesario a trav√©s de DNF:\nInstalamos primeramente el repositorio free:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo dnf install https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003erpm -E %fedora\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e.noarch.rpm\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eY despu√©s instalamos el non-free que es donde se alojan los drivers de Nvidia:\u003c/p\u003e","title":"Drivers Nvidia"},{"content":"FirewallD Instalaci√≥n y configuraci√≥n del firewallD\nSi queremos tener el applet en la barra de tareas de gnome a√±adimos lo siguiente:\nsudo dnf install firewall-config firewall-applet -y FirewalID deber√≠a estar ya habilitado por defecto, lo comprobamos: La mejor pr√°ctica es habilitar autom√°ticamente el software de firewall al iniciar el sistema e iniciarlo de inmediato. Esto se puede lograr con un comando todo en uno de la siguiente manera.\nsudo systemctl enable firewalld --now A continuaci√≥n, verificamos el estado de FirewallD para asegurarse de que todo funcione y no haya errores.\nsystemctl status firewalld Despu√©s a√±adimos a los programas de inicio el firewall-applet de la siguiente forma:\ncd ~/.config/autostart touch firewall-applet.desktop nano firewall-applet.desktop A√±adimos el siguiente texto:\n[Desktop Entry] Name=Firewall Applet Comment=Firewall Applet Icon=firewall-config Categories=System;Settings;Security; #Translators: These are searchable keywords for the firewall configuration tool Keywords=firewall;network;security;iptables;netfilter; Exec=/usr/bin/firewall-applet Type=Application StartupNotify=true Terminal=false X-Desktop-File-Install-Version=0.26 Las reglas del firewall para aplicaciones y dem√°s ya es configurar a gusto del usuario.\nFuentes:\nhttps://fedoraproject.org/wiki/FirewallD/es\n","permalink":"https://blog.lasnotasdenoah.com/posts/firewalld/","summary":"\u003ch2 id=\"firewalld\"\u003eFirewallD\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eInstalaci√≥n y configuraci√≥n del firewallD\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eSi queremos tener el applet en la barra de tareas de gnome a√±adimos lo siguiente:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo dnf install firewall-config firewall-applet -y\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eFirewalID deber√≠a estar ya habilitado por defecto, lo comprobamos:\nLa mejor pr√°ctica es habilitar autom√°ticamente el software de firewall al iniciar el sistema e iniciarlo de inmediato.\nEsto se puede lograr con un comando todo en uno de la siguiente manera.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo systemctl enable firewalld --now\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eA continuaci√≥n, verificamos el estado de FirewallD para asegurarse de que todo funcione y no haya errores.\u003c/p\u003e","title":"Firewalld Instalaci√≥n"},{"content":"Primeros pasos despu√©s de instalar Fedora o Debian NOTA: Aunque la mayor parte de este post se centra en Fedora, debo decir que Debian para m√≠ siempre ser√° la mejor, por ese motivo he a√±adido unas notas sobre instalaci√≥n en Debian. Configurar DNF para descargas m√°s r√°pidas:\nsudo nano /etc/dnf/dnf.conf y a√±adimos la siguiente l√≠nea:\nmax_parallel_downloads=10 Realizamos una acutalizaci√≥n completa del sistema:\nsudo dnf upgrade -y Habilitamos los respostorios de RPM Fusion:\nsudo dnf install https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm sudo dnf install https://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm Compatibilidad con ciertos formatos comprimidos, as√≠ como OpenSSL para usar la extensi√≥n GSConnect:\nsudo dnf install openssl unrar p7zip p7zip-plugins Principales codecs multimedia:\nsudo dnf install gstreamer1-plugins-bad-free-extras gstreamer1-plugin-openh264 gstreamer1-plugins-good-extras mozilla-openh264 gstreamer1-plugins-bad-free-fluidsynth gstreamer1-plugins-bad-free-wildmidi gstreamer1-svt-av1 sudo dnf install vlc ACTUALIZACI√ìN 28/07/2025 He tenido problemas de reproducci√≥n de videos H.265 del sistema CCTV. Para solucionarlo he tenido que instalar los siguientes paquetes seg√∫n este hilo de los foros de Fedora:\nEsto creo que no es necesario porque los repositorios rpmfusion ya deber√≠an estar instalados de los pasos anteriores:\nsudo dnf install https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm sudo dnf install https://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm sudo dnf install libavcodec-freeworld --allowerasing sudo dnf install intel-media-driver --allowerasing Por defecto Fedora ofrece la versi√≥n libre para el c√≥dec de v√≠deo H264, que resulta insuficiente. Con la anterior orden ampliamos el soporte, pero si usamos Firefox debemos efectuar un peque√±o cambio: Men√∫ \u0026gt; Complementos y temas \u0026gt; Plugins, y all√≠ activaremos el c√≥dec Open H264 de Cisco. Esta informaci√≥n ha sido obtenida de la web thecheis.com.\nA√±adimos el repositorio de Flathub:\nflatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo Solo para Debian Si queremos tener disponible el software de faltpak en el administrador de software de gnome debemos instalar el siguiente paquete:\nsudo apt install gnome-software-plugin-flatpak En la instalaci√≥n Fedora no pregunta por el nombre del host. Ahora podemos modificarlo:\nsudo hostnamectl set-hostname \u0026#34;New_Custom_Name\u0026#34; Instalamos las aplicaciones esenciales para personalizar Gnome:\nsudo dnf install gnome-tweaks gnome-extensions-app Instalamos tambi√©n Extension Manager desde el administrador de Software de Gnome (es una aplicaci√≥n Flatpak).\nInstalamos Flatseal y Warehouse, que son aplicaciones de Flatpak para gestionar permisos y almacenamientos de estas aplicaciones. Extensiones instaladas: Habilitamos Maximizar y Minimizar en las ventanas:\nHabilitar/deshabilitar los informes de errores: Configuraciones de energ√≠a: Habilitamos luz nocturna para reducir la fatiga visual: Ordenaci√≥n de directorios antes de los ficheros: Configuraciones de papelera de reciclaje: Nota: Lista de flatpak que he instalado a mayores de lo que hab√≠a:\nWarp app.drey.Warp 0.6.1 stable flathub system teams-for-linux com.github.IsmaelMartinez.teams_for_linux 1.3.19 stable flathub system Flatseal com.github.tchx84.Flatseal 2.1.0 stable flathub system IntelliJ IDEA Community com.jetbrains.IntelliJ-IDEA-Community 2023.2.5 stable flathub system Extension Manager com.mattjakeman.ExtensionManager 0.4.3 stable flathub system Warehouse io.github.flattool.Warehouse 1.3.0 stable flathub system Kooha io.github.seadve.Kooha 2.2.4 stable flathub system SaveDesktop io.github.vikdevelop.SaveDesktop 2.9 stable flathub system Photoflare io.photoflare.photoflare 1.6.13 stable flathub system Joplin net.cozic.joplin_desktop 2.12.19 stable flathub system Geary org.gnome.Geary 44.1 stable fedora system Kasts org.kde.kasts 23.08.1 stable fedora system Nota: Lista de paquetes instalados por dnf:\n8 sudo dnf install vlc conky zsh 14 sudo dnf install teams 17 sudo dnf install gnome-tweaks gnome-extensions-app 19 sudo dnf install timeshift 20 sudo dnf install firewall-config firewall-applet 28 sudo dnf install translate-shell 31 sudo dnf install nvme-cli 38 sudo dnf install etherwake 39 sudo dnf install ether-wake 40 sudo dnf install net-tools 43 sudo dnf install thunderbird # Ya no lo uso, ahora uso Geary 55 sudo dnf install wireguard-tools 72 sudo dnf install code 149 sudo dnf install util-linux-user 456 sudo dnf install codium 794 sudo dnf install nextcloud-client-nautilus nextcloud-client 1013 sudo dnf install brave-browser 1016 sudo dnf install photoflare 1295 sudo dnf install telegram-desktop 1965 sudo dnf install steam 2291 sudo dnf install dconf-editor 2348 sudo dnf install htop 2351 sudo dnf install gstreamer1-plugins-bad-free-extras gstreamer1-plugin-openh264 gstreamer1-plugins-good-extras mozilla-openh264 gstreamer1-plugins-bad-free-fluidsynth gstreamer1-plugins-bad-free-wildmidi gstreamer1-svt-av1 2352 sudo dnf install openssl unrar p7zip p7zip-plugins Nota: Lista de paquetes instalados por apt:\nsudo apt install zram-tools sudo apt install flatpak sudo apt install gnome-software-plugin-flatpak sudo apt autoremove gnome-games sudo apt install nextcloud-desktop nautilus-nextcloud Fuentes:\nhttps://itsfoss.com/things-to-do-after-installing-fedora/\nhttps://thecheis.com/2023/08/09/puesta-a-punto-intel-nuc-fedora/\n","permalink":"https://blog.lasnotasdenoah.com/posts/primeros-pasos/","summary":"\u003ch2 id=\"primeros-pasos-despu√©s-de-instalar-fedora-o-debian\"\u003ePrimeros pasos despu√©s de instalar Fedora o Debian\u003c/h2\u003e\n\u003cp\u003eNOTA: Aunque la mayor parte de este post se centra en Fedora, debo decir que Debian para m√≠ siempre ser√° la mejor, por ese motivo he a√±adido unas notas sobre instalaci√≥n en Debian.\nConfigurar DNF para descargas m√°s r√°pidas:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo nano /etc/dnf/dnf.conf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ey a√±adimos la siguiente l√≠nea:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emax_parallel_downloads\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eRealizamos una acutalizaci√≥n completa del sistema:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo dnf upgrade -y\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eHabilitamos los respostorios de RPM Fusion:\u003c/p\u003e","title":"Primeros pasos con Fedora Gnome"},{"content":"System quitar entradas antiguas de UEFI Instalarci√≥n Zsh Alias .zshrc (fichero .zshrc) firewall-config y firewall-applet (ojo a√±adir firewall-applet al arranque del sistema) Instalaci√≥n conky (fichero .conkyrc) Traductor de consola (sudo apt install translate-shell) Apps Configuraci√≥n Flatpak Timeshift Deja-dup Insync Nextcloud Joplin (Flatpak) Thunderbird o Geary (Actualmente estoy con Geary) Idioma thunderbird Libreoffice Idioma en Libreoffice - OK Kooha (Flatpak) Teams Telegram Boxes de Gnome Virtual box Network Configurar claves ssh con NAS principal Configurar claves ssh con NAS secundario Configurar accesos smb al NAS principal Configurar accesos smb al NAS secundario a trav√©s de Zerotier o Tailscale Con tailscale el recurso compartido en smb es: smb://xxx.xxx.xxx.xxx/Recurso_compartido Configurar claves ssh con ROUTERS Configurar el cliente Wireguard de nuestra VPN al NAS (para debian): sudo apt install wireguard Copiamos el fichero wg0.conf generado por el servidor a la carpeta /etc/wireguard sudo wg-quick up wg0 - Conexi√≥n a la VPN sudo wg-quick down wg0 - Desconexi√≥n a la VPN Configurar VPN de pago en Gnome Instalar antes el paquete network-manager-openvpn-gnome Configuraci√≥n ZeroTier (ultima versi√≥n da fallo en Debian testing) Configuraci√≥n Tailscale Configuraci√≥n NextDNS curl -fsSL https://tailscale.com/install.sh | sh (en la web de Tailscale se detalla) Instalar extensi√≥n Gnome: Tailscale Status Desktop Primeros pasos con Gnome (https://itsfoss.com/things-to-do-after-installing-fedora/) Tweeks Gnome extensions Extension manager (est√° como paquete en Flathub) Minimizar y Maximizar Night-light settings Cambiar primer dia calendario (Generar locales Debian) A√±adir accesos directos Office Online Nuevo documento en plantillas de nautilus SaveDesktop - Backup de la configuraci√≥n de escritorio Programming visual studio code Python entornos virtuales ","permalink":"https://blog.lasnotasdenoah.com/posts/mis-imprescindibles/","summary":"\u003ch2 id=\"system\"\u003eSystem\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e quitar entradas antiguas de UEFI\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e \u003ca href=\"/posts/zsh/index.html\"\u003eInstalarci√≥n Zsh\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Alias .zshrc \u003ca href=\"/assets/files/zshrc\"\u003e(fichero .zshrc)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e firewall-config y firewall-applet (ojo a√±adir firewall-applet al arranque del sistema)\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Instalaci√≥n conky \u003ca href=\"/assets/files/conkyrc\"\u003e(fichero .conkyrc)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Traductor de consola (sudo apt install translate-shell)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"apps\"\u003eApps\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e \u003ca href=\"/posts/Flatpak/index.html\"\u003eConfiguraci√≥n Flatpak\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Timeshift\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Deja-dup\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Insync\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Nextcloud\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Joplin (Flatpak)\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Thunderbird o Geary (Actualmente estoy con Geary)\n\u003cul\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Idioma thunderbird\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Libreoffice\n\u003cul\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Idioma en Libreoffice - OK\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Kooha (Flatpak)\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Teams\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Telegram\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Boxes de Gnome\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Virtual box\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"network\"\u003eNetwork\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Configurar claves ssh con NAS principal\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Configurar claves ssh con NAS secundario\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Configurar accesos smb al NAS principal\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Configurar accesos smb al NAS secundario a trav√©s de Zerotier o Tailscale\n\u003cul\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Con tailscale el recurso compartido en smb es:\nsmb://xxx.xxx.xxx.xxx/Recurso_compartido\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Configurar claves ssh con ROUTERS\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Configurar el cliente Wireguard de nuestra VPN al NAS (para debian):\n\u003cul\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e sudo apt install wireguard\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Copiamos el fichero wg0.conf generado por el servidor a la carpeta /etc/wireguard\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e sudo wg-quick up wg0 - Conexi√≥n a la VPN\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e sudo wg-quick down wg0 - Desconexi√≥n a la VPN\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Configurar VPN de pago en Gnome\n\u003cul\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Instalar antes el paquete network-manager-openvpn-gnome\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Configuraci√≥n ZeroTier (ultima versi√≥n da fallo en Debian testing)\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Configuraci√≥n Tailscale\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Configuraci√≥n NextDNS\n\u003cul\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e curl -fsSL \u003ca href=\"https://tailscale.com/install.sh\"\u003ehttps://tailscale.com/install.sh\u003c/a\u003e | sh (en la web de Tailscale se detalla)\n\u003cul\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Instalar extensi√≥n Gnome: Tailscale Status\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"desktop\"\u003eDesktop\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Primeros pasos con Gnome (\u003ca href=\"https://itsfoss.com/things-to-do-after-installing-fedora/\"\u003ehttps://itsfoss.com/things-to-do-after-installing-fedora/\u003c/a\u003e)\n\u003cul\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Tweeks\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Gnome extensions\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Extension manager (est√° como paquete en Flathub)\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Minimizar y Maximizar\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Night-light settings\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Cambiar primer dia calendario (\u003ca href=\"/posts/locales/index.html\"\u003eGenerar locales Debian\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e A√±adir accesos directos Office Online\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Nuevo documento en plantillas de nautilus\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e SaveDesktop - Backup de la configuraci√≥n de escritorio\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"programming\"\u003eProgramming\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e visual studio code\u003c/li\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e Python entornos virtuales\u003c/li\u003e\n\u003c/ul\u003e","title":"Software imprescindible"},{"content":"Instalaci√≥n nuevos locales en Debian Revisamos los locales que tenemos generados en el sistema:\nlocale -a Podemos generar m√°s editando /etc/locale.gen y descomentando la l√≠nea que nos interesa:\nes_ES.UTF-8 UTF-8 Generamos nuevamente los locales con:\nlocale-gen Hacemos el cambio en \u0026ldquo;Region \u0026amp; Language\u0026rdquo;\n","permalink":"https://blog.lasnotasdenoah.com/posts/locales-debian/","summary":"\u003ch2 id=\"instalaci√≥n-nuevos-locales-en-debian\"\u003eInstalaci√≥n nuevos locales en Debian\u003c/h2\u003e\n\u003cp\u003eRevisamos los locales que tenemos generados en el sistema:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003elocale -a\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ePodemos generar m√°s editando /etc/locale.gen y descomentando la l√≠nea que nos interesa:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ees_ES.UTF-8 UTF-8\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eGeneramos nuevamente los locales con:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003elocale-gen\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eHacemos el cambio en \u0026ldquo;Region \u0026amp; Language\u0026rdquo;\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"Region\" loading=\"lazy\" src=\"/posts/locales-debian/1.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"vista\" loading=\"lazy\" src=\"/posts/locales-debian/2.png\"\u003e\u003c/p\u003e","title":"Locales Debian"},{"content":"Soporte Flatpak en Debian 11¬†Bullseye Informaci√≥n en la web oficial de Flatpak.\nAunque, a mi modo de ver, es importante instalar el software con la paqueter√≠a .deb, en ocasiones es necesario usar flatpak porque el software no est√° disponible en otro formato.\nInstalamos el paquete flatpak\nDependiendo nuestro sistema operativo, el comando ser√° el siguiente:\n# Debian apt install flatpak # Fedora dnf install flatpak Instalamos el plugin para la tienda de software. En este caso la tienda de Gnome.\napt install gnome-software-plugin-flatpak Agregamos el repositorio de Flathub\nflatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo Para buscar una aplicaci√≥n en Flathub:\nflatpak search firefox Listado de aplicaciones flatpak instaladas\nflatpak list Listado limpio que solo enumera las aplicaciones\nflatpak list --app Para eliminar un flatpak, primero debemos obtener el ID de la aplicaci√≥n y ejecutar el siguiente comando\nflatpak uninstall --delete-data org.mozilla.firefox Para eliminar un flatpak, primero debemos obtener el ID de la aplicaci√≥n y ejecutar el siguiente comando\nflatpak uninstall --delete-data org.mozilla.firefox Elimina todas la librer√≠as que no est√°n en uso por ninguna app instalada, o las versiones antiguas residuales que ya han sido actualizadas\nflatpak uninstall --unused Para eliminar completamente Flatpak del sistema ejecutamos:\nsudo flatpak repair Despu√©s podemos seguir con los comandos:\nsudo apt autoremove flatpak sudo apt purge flatpak ","permalink":"https://blog.lasnotasdenoah.com/posts/flatpak/","summary":"\u003ch2 id=\"soporte-flatpak-en-debian-11bullseye\"\u003eSoporte Flatpak en Debian 11¬†Bullseye\u003c/h2\u003e\n\u003cp\u003eInformaci√≥n en la \u003ca href=\"https://flatpak.org/setup/Debian/\"\u003eweb oficial de Flatpak\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eAunque, a mi modo de ver, es importante instalar el software con la paqueter√≠a .deb, en ocasiones es necesario usar flatpak porque el software no est√° disponible en otro formato.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eInstalamos el paquete flatpak\u003c/strong\u003e\u003cbr\u003e\nDependiendo nuestro sistema operativo, el comando ser√° el siguiente:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Debian\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eapt install flatpak\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Fedora\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ednf install flatpak\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eInstalamos el plugin para la tienda de software. En este caso la tienda de Gnome.\u003c/strong\u003e\u003c/p\u003e","title":"Flatpak"},{"content":"Seg√∫n su web, NextDNS ofrece un firewall para la Internet moderna. NextDNS protege de todo tipo de amenazas a la seguridad, bloquea anuncios y rastreadores en sitios web y aplicaciones, y brinda una Internet segura y supervisada para ni√±os, en todos los dispositivos y en todas las redes.\nMe parece un servicio genial por 20‚Ç¨ al a√±o que ofrece mucha seguridad a la hora de navegar por internet.\nConfiguraci√≥n de DNS privado en Fedora En nuestro sistema Fedora, estar√°n conviviendo NetworkMananger con systemd-resolved, por tanto, el primer paso que debemos hacer es indicarle a NetworkManager que la resoluci√≥n de DNS se va a realizar con systemd-resolved.\nEditamos el fichero /etc/NetworkManager/conf.d/dns.conf y a√±adimos el siguiente contenido:\n[main] dns=systemd-resolved En versiones actuales del servicio systemd-resolved el fichero de configuraci√≥n resolved.conf se encuentra en /etc/systemd/resolved.conf.d/, anteriormente se encontraba en /etc/systemd/\nCreamos el fichero resolved.conf en la ruta /etc/systemd/resolved.conf.d:\nTenemos como ejemplo los DNS de quad9, que funcionan muy bien:\n[Resolve] DNS=9.9.9.9#dns.quad9.net DNSOverTLS=yes En nuestro caso vamos a usar los DNS de NetxDNS, para ello accedemos a nuestro panel de usuario de NextDNS y copiamos la configuraci√≥n:\n[Resolve] DNS=xx.xx.xx.xx#AAAAAAAA.dns.nextdns.io DNS=xx.xx.xx.xx#AAAAAAAA.dns.nextdns.io DNS=xx.xx.xx.xx#AAAAAAAA.dns.nextdns.io DNS=xx.xx.xx.xx#AAAAAAAA.dns.nextdns.io DNSOverTLS=yes En Fedora ya deber√≠a estar el enlace simb√≥lico de /etc/resolv.conf. Lo comprobamos y sino procedemos a crearlo:\nsudo ln -sf ../run/systemd/resolve/stub-resolv.conf /etc/resolv.conf El servicio systemd-resolved deber√≠a estar habilitado, sino lo habilitamos:\nsudo systemctl status systemd-resolved.service sudo systemctl enable systemd-resolved.service Podemos habilitar el registro de logs para detectar errores en la resoluci√≥n de DNS:\nsudo resolvectl log-level debug journalctl -u systemd-resolved -f Como en nuestro sistema tenemos conviviendo systemd-resolved con NetworkManager, debemos reiniciar ambos para que todo funcione correctamente:\nsudo systemctl restart systemd-resolved.service \u0026amp;\u0026amp; sudo service NetworkManager restart Verificamos si est√° bien configurada la resoluci√≥n de nombres:\nresolvectl status Por √∫ltimo, si accedemos a nuestro panel de NextDNS veremos que ya estamos trabajando con sus servidores.\nNota importante: En mi caso tuve problemas con la resoluci√≥n de nombres porque tengo configuradas varias redes en mi equipo. La red que me gener√≥ problemas era la que crea TailScale, la red tailscale0.\nEn el panel de control de Tailscale ten√≠a configurada la resoluci√≥n de nombres a trav√©s de un perfil diferente de NextDNS, entonces al acceder al panel de control de NextDNS, por motivos que desconozco mi port√°til Fedora hac√≠a la resoluci√≥n de nombres a trav√©s del perfil configurado en Tailscale en lugar del perfil configurado en el equipo.\nNo he descubierto porque lo hace as√≠, la soluci√≥n fue sencilla, a trav√©s de la extensi√≥n de Tailscale Status de Gnome habilito la red de Tailscale cuando es necesario para conectarme a mis NAS de forma remota.\nACTUALIZACI√ìN 26/07/2025 En mi √∫ltima configuraci√≥n de Fedora 42 con KDE he tenido que seguir al pie de la letra la siguiente guia para que funcione.\nPor el motivo que sea el fichero /etc/systemd/resolved.conf.d/resolved.conf no se lee por systemd-resolved y no se aplica la configuraci√≥n.\nSi configuramos los datos de NEXTDNS en el fichero /etc/systemd/resolved.conf, todo comenz√≥ a funcionar a la primera.\nFuentes:\nhttps://nextdns.io/\nhttps://www.adityathebe.com/systemd-resolved-dns-over-tls/\nhttps://dev.to/archerallstars/using-dns-over-tls-on-opensuse-linux-in-4-easy-steps-enable-cloud-firewall-for-free-today-2job\nhttps://docs.quad9.net/Setup_Guides/Linux_and_BSD/Ubuntu_22.04_%28Encrypted%29/#instructions\n","permalink":"https://blog.lasnotasdenoah.com/posts/dns-over-tls/","summary":"\u003cp\u003eSeg√∫n su \u003ca href=\"https://nextdns.io/\"\u003eweb\u003c/a\u003e, NextDNS ofrece un firewall para la Internet moderna. NextDNS protege de todo tipo de amenazas a la seguridad, bloquea anuncios y rastreadores en sitios web y aplicaciones, y brinda una Internet segura y supervisada para ni√±os, en todos los dispositivos y en todas las redes.\u003cbr\u003e\nMe parece un servicio genial por 20‚Ç¨ al a√±o que ofrece mucha seguridad a la hora de navegar por internet.\u003c/p\u003e\n\u003ch2 id=\"configuraci√≥n-de-dns-privado-en-fedora\"\u003eConfiguraci√≥n de DNS privado en Fedora\u003c/h2\u003e\n\u003cp\u003eEn nuestro sistema Fedora, estar√°n conviviendo NetworkMananger con systemd-resolved, por tanto, el primer paso que debemos hacer es indicarle a NetworkManager que la resoluci√≥n de DNS se va a realizar con systemd-resolved.\u003cbr\u003e\nEditamos el fichero \u003cstrong\u003e/etc/NetworkManager/conf.d/dns.conf\u003c/strong\u003e y a√±adimos el siguiente contenido:\u003c/p\u003e","title":"DNS Over TLS"},{"content":"Configuraci√≥n WOL desde Internet en router Asus Instalaci√≥n y configuraci√≥n del firewallD\nEl primer paso es hacer una redirecci√≥n de puertos en el router: Elegimos un puerto aleatorio externo (que sea alto) y redireccionamos al puerto 9 a la IP 192.168.1.254:\nAccedemos al router por ssh y creamos una nueva entrada en la tabla arp del router para reenviar el paquete WOL al broadcast de la red FF:FF:FF:FF:FF:FF (a todas las direcciones MAC):\narp -s 192.168.1.254 ff:ff:ff:ff:ff:ff Verificamos que se ha creado la nueva entrada:\nadmin@(none):/jffs/scripts# arp ? (192.168.1.155) at \u0026lt;incomplete\u0026gt; on br0 ? (XXX.XXX.178.1) at XX:XX:XX:XX:fc:81 [ether] on eth0 ? (192.168.1.254) at ff:ff:ff:ff:ff:ff [ether] PERM on br0 \u0026lt;---- ? (192.168.1.58) at XX:XX:XX:XX:4c:c4 [ether] on br0 ? (192.168.1.251) at XX:XX:XX:XX:5d:0a [ether] on br0 ? (192.168.1.170) at XX:XX:XX:XX:0e:f3 [ether] on br0 ? (192.168.1.40) at XX:XX:XX:XX:8a:58 [ether] on br0 Ahora simplemente es necesario configurar nuestra aplicaci√≥n WOL para enviar el magic packet:\nDIRECCION MAC: La de nuestro dispositivo que deseamos levantar HOSTNAME/IP: myDDNS.asuscomm.com PUERTO: Seg√∫n el ejemplo 4231 Esta configuraci√≥n del router desaparecer√° con el siguiente reinicio. Para dejarla permanente creamos un peque√±o script que haga este trabajo en cada reinicio: Los router Asus tienen un almacenamiento permanente en /jffs Creamos un directorio dentro de /jffs llamado scrits y creamos el siguiente fichero:\ncat \u0026lt;\u0026lt;EOF \u0026gt; wan-wol.sh #!/bin/sh scriptName=\u0026#34;/jffs/scripts/\\$(basename $0)\u0026#34; myIp=\u0026#34;192.168.1.254\u0026#34; /usr/bin/logger -t \u0026#34;\\${scriptName}\u0026#34; \\$$ \u0026#34;arp -s \\${myIp} ff:ff:ff:ff:ff:ff\u0026#34; arp -s \\$myIp ff:ff:ff:ff:ff:ff /usr/bin/logger -t \u0026#34;\\${scriptName}\u0026#34; \\$$ \u0026#34;Check: \\$(arp | grep $myIp)\u0026#34; EOF Verificamos que est√© bien:\ncat /jffs/scripts/wan-wol.sh Resultado correcto:\n#!/bin/sh scriptName=\u0026#34;/jffs/scripts/$(basename $0)\u0026#34; myIp=\u0026#34;192.168.1.254\u0026#34; /usr/bin/logger -t \u0026#34;${scriptName}\u0026#34; $$ \u0026#34;arp -s $myIp ff:ff:ff:ff:ff:ff\u0026#34; arp -s $myIp ff:ff:ff:ff:ff:ff /usr/bin/logger -t \u0026#34;${scriptName}\u0026#34; $$ \u0026#34;Check: $(arp | grep $myIp)\u0026#34; Los hacemos ejecutable:\nadmin@(none):/jffs/scripts# chmod a+x wan-wol.sh master@(none):/tmp/home/root# nvram show 2\u0026gt;\u0026amp;1 | grep script_usbmount script_usbmount= master@(none):/jffs/scripts# nvram set script_usbmount=\u0026#34;/jffs/scripts/wan-wol.sh\u0026#34; master@(none):/jffs/scripts# nvram commit master@(none):/jffs/scripts# nvram show 2\u0026gt;\u0026amp;1 | grep script_usbmount script_usbmount=/jffs/scripts/wan-wol.sh Despu√©s de reiniciar el router deber√≠a haberse ejecutado el script para crear la entrada en la tabla arp: Fuentes:\nhttps://andblu.blogspot.com/2016/08/configure-wol-from-internet-wan-asus.html\n","permalink":"https://blog.lasnotasdenoah.com/posts/wol-wan/","summary":"\u003ch2 id=\"configuraci√≥n-wol-desde-internet-en-router-asus\"\u003eConfiguraci√≥n WOL desde Internet en router Asus\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eInstalaci√≥n y configuraci√≥n del firewallD\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eEl primer paso es hacer una redirecci√≥n de puertos en el router:\nElegimos un puerto aleatorio externo (que sea alto) y redireccionamos al puerto 9 a la IP 192.168.1.254:\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"Foto 1 puertos\" loading=\"lazy\" src=\"/posts/wol-wan/redirect-puertos.png\"\u003e\u003c/p\u003e\n\u003cp\u003eAccedemos al router por ssh y creamos una nueva entrada en la tabla arp del router para reenviar el paquete WOL al broadcast de la red FF:FF:FF:FF:FF:FF (a todas las direcciones MAC):\u003c/p\u003e","title":"Wake On Lan WAN"},{"content":"Instalaci√≥n y configuraci√≥n de zsh con oh-my-zsh Instalaci√≥n zsh Dependiendo nuestro sistema operativo, el comando ser√° el siguiente:\n# Debian sudo apt install git zsh util-linux-user # Fedora sudo dnf install zsh git Clonamos el repositorio de oh-my-zsh\ngit clone https://github.com/ohmyzsh/ohmyzsh.git ~/.oh-my-zsh Usamos la primera plantilla para el fichero .zshrc\ncp ~/.oh-my-zsh/templates/zshrc.zsh-template ~/.zshrc Cambiamos la terminal por defecto de nuestro usuario\nsudo chsh -s /bin/zsh user_____ Instalaci√≥n del tema Powerlevel10k\ngit clone --depth=1 https://github.com/romkatv/powerlevel10k.git ~/.oh-my-zsh/custom/themes/powerlevel10k echo \u0026#39;source ~/.oh-my-zsh/custom/themes/powerlevel10k/powerlevel10k.zsh-theme\u0026#39; \u0026gt;\u0026gt;~/.zshrc Modificamos el fichero .zshrc\nZSH_THEME=\u0026#34;robbyrussell\u0026#34; reemplazarlo por ZSH_THEME=\u0026#34;powerlevel10k/powerlevel10k\u0026#34; Fuentes recomendadas para el tema MesloLGS NF Enlace en mi github Copiamos las fuentes a su ubicaci√≥n y configuramos Gnome terminal con la fuente recomendada\n/usr/share/fonts/truetype Reiniciar la termninal, si no arranca la configuraci√≥n inicial, siguiente comando\np10k configure Instalaci√≥n de los plugins\nplugins=( git sudo web-search history zsh-autosuggestions zsh-syntax-highlighting zsh-completions zsh-dircolors-solarized ) Los √∫nicos plugin que requiere instalaci√≥n manual es zsh-autosuggestions:\nzsh-autosuggestions\nzsh-completions\nsh-syntax-highlighting\nzsh-dircolors-solarized\nClonamos los repositorios y a√±adimos los nombres al apartado plugins del fichero .zshrc:\ngit clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting git clone https://github.com/zsh-users/zsh-completions ${ZSH_CUSTOM:=~/.oh-my-zsh/custom}/plugins/zsh-completions git clone --recursive https://github.com/joel-porquet/zsh-dircolors-solarized $ZSH_CUSTOM/plugins/zsh-dircolors-solarized Este √∫ltimo plugin el zsh-dircolors-solarized, despues de a√±adirlo a la secci√≥n plugins, es necesario ejecutar el siguiente comando para establecer los valores por defecto: setupsolarized.\nEl resto de plugins simplemente hay que a√±adirlo a la secci√≥n plugins de .zshrc: sudo web-search history\nFuentes:\nhttps://terminaldelinux.com/terminal/introduccion/instalacion-zsh/\nhttps://blog.linuxitos.com/post/instalar-zsh-y-tema-powerlevel10k-fedora-33\nhttps://travis.media/top-10-oh-my-zsh-plugins-for-productive-developers/#20210719-sudo\n","permalink":"https://blog.lasnotasdenoah.com/posts/zsh/","summary":"\u003ch2 id=\"instalaci√≥n-y-configuraci√≥n-de-zsh-con-oh-my-zsh\"\u003eInstalaci√≥n y configuraci√≥n de zsh con oh-my-zsh\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eInstalaci√≥n zsh\u003c/strong\u003e\nDependiendo nuestro sistema operativo, el comando ser√° el siguiente:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Debian\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo apt install git zsh util-linux-user\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Fedora\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo dnf install zsh git\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eClonamos el repositorio de oh-my-zsh\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit clone https://github.com/ohmyzsh/ohmyzsh.git ~/.oh-my-zsh\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eUsamos la primera plantilla para el fichero .zshrc\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecp ~/.oh-my-zsh/templates/zshrc.zsh-template ~/.zshrc\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eCambiamos la terminal por defecto de nuestro usuario\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo chsh -s /bin/zsh user_____\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eInstalaci√≥n del tema\u003c/strong\u003e \u003ca href=\"https://github.com/romkatv/powerlevel10k\"\u003ePowerlevel10k\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit clone --depth\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e https://github.com/romkatv/powerlevel10k.git ~/.oh-my-zsh/custom/themes/powerlevel10k\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;source ~/.oh-my-zsh/custom/themes/powerlevel10k/powerlevel10k.zsh-theme\u0026#39;\u003c/span\u003e \u0026gt;\u0026gt;~/.zshrc\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eModificamos el fichero .zshrc\u003c/p\u003e","title":"Zsh"}]